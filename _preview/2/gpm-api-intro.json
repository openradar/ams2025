{"version":1,"kind":"Notebook","sha256":"bd66d7a55c62cf8457b92214b702d7ebca2a89dfe324819d8caab4a534e0717d","slug":"gpm-api-intro","location":"/notebooks/gpm-api/gpm-api-intro.ipynb","dependencies":[],"frontmatter":{"title":"Introduction to GPM-API","content_includes_title":false,"kernelspec":{"name":"gpm-api-dev","display_name":"gpm-api-dev","language":"python"},"authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/openradar/erad2024","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"gpm-api-intro.ipynb","url":"/ams2025/_preview/2/build/gpm-api-intro-2402cf5cfeccb09027c07cb30a8ca544.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this tutorial, we will provide the foundations to use GPM-API to download, manipulate and analyze data from the Global Precipitation Measurement (GPM) spaceborne radars.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NXXtSwSQd9"}],"key":"FGZfL0tVCF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Please note that GPM-API also enable access and analysis tools for the entire GPM constellation of passive microwave sensors as well as the IMERG precipitation products.\nFor detailed information and additional tutorials, please refer to the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Yaa9eYqkFb"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"official GPM-API documentation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"j1Tf0Y2r0X"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/","key":"j3LzXN04lp"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OEZXNX3An9"}],"key":"rSatefeziN"}],"key":"ZSgnptwHqL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, let’s import the package required in this tutorial.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rW9OR7POHA"}],"key":"hLeL5bG3Hz"}],"key":"VeGm9Wp1IF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import datetime\nimport gpm\nimport fsspec\nimport numpy as np\nimport ximage  # noqa\nimport xarray as xr\nfrom xarray.backends.api import open_datatree\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nfrom gpm.utils.geospatial import (\n    get_country_extent,\n    get_geographic_extent_around_point,\n    get_circle_coordinates_around_point,\n)\nfrom gpm.gv import volume_matching, compare_maps, calibration_summary","key":"D6vs6rH8l7"},{"type":"output","id":"Vu9-KRiQgJ-BZ5Up1nwlb","data":[],"key":"t28bYLBq5R"}],"key":"eADQSWZR6F"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"miiP97YeEp"},{"type":"inlineCode","value":"available_products","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yp9k9X7osW"},{"type":"text","value":" function, users can obtain a list of all GPM products that can be downloaded and opened into CF-compliant xarray datasets.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"abPTC7S4c8"}],"key":"H2UgIlOvWc"}],"key":"M4xKFFbdn0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gpm.available_products(product_types=\"RS\")  # research products","key":"B09xthLl8E"},{"type":"output","id":"p3_aFLlfbKZ-OAKf3h-Ie","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"['1A-GMI',\n '1A-TMI',\n '1B-GMI',\n '1B-Ka',\n '1B-Ku',\n '1B-PR',\n '1B-TMI',\n '1C-AMSR2-GCOMW1',\n '1C-AMSRE-AQUA',\n '1C-AMSUB-NOAA15',\n '1C-AMSUB-NOAA16',\n '1C-AMSUB-NOAA17',\n '1C-ATMS-NOAA20',\n '1C-ATMS-NOAA21',\n '1C-ATMS-NPP',\n '1C-GMI',\n '1C-GMI-R',\n '1C-MHS-METOPA',\n '1C-MHS-METOPB',\n '1C-MHS-METOPC',\n '1C-MHS-NOAA18',\n '1C-MHS-NOAA19',\n '1C-SAPHIR-MT1',\n '1C-SSMI-F08',\n '1C-SSMI-F10',\n '1C-SSMI-F11',\n '1C-SSMI-F13',\n '1C-SSMI-F14',\n '1C-SSMI-F15',\n '1C-SSMIS-F16',\n '1C-SSMIS-F17',\n '1C-SSMIS-F18',\n '1C-SSMIS-F19',\n '1C-TMI',\n '2A-AMSR2-GCOMW1',\n '2A-AMSR2-GCOMW1-CLIM',\n '2A-AMSRE-AQUA-CLIM',\n '2A-AMSUB-NOAA15-CLIM',\n '2A-AMSUB-NOAA16-CLIM',\n '2A-AMSUB-NOAA17-CLIM',\n '2A-ATMS-NOAA20',\n '2A-ATMS-NOAA20-CLIM',\n '2A-ATMS-NOAA21',\n '2A-ATMS-NOAA21-CLIM',\n '2A-ATMS-NPP',\n '2A-ATMS-NPP-CLIM',\n '2A-DPR',\n '2A-ENV-DPR',\n '2A-ENV-Ka',\n '2A-ENV-Ku',\n '2A-ENV-PR',\n '2A-GMI',\n '2A-GMI-CLIM',\n '2A-GPM-SLH',\n '2A-Ka',\n '2A-Ku',\n '2A-MHS-METOPA',\n '2A-MHS-METOPA-CLIM',\n '2A-MHS-METOPB',\n '2A-MHS-METOPB-CLIM',\n '2A-MHS-METOPC',\n '2A-MHS-METOPC-CLIM',\n '2A-MHS-NOAA18',\n '2A-MHS-NOAA18-CLIM',\n '2A-MHS-NOAA19',\n '2A-MHS-NOAA19-CLIM',\n '2A-PR',\n '2A-SAPHIR-MT1',\n '2A-SAPHIR-MT1-CLIM',\n '2A-SSMI-F08-CLIM',\n '2A-SSMI-F10-CLIM',\n '2A-SSMI-F11-CLIM',\n '2A-SSMI-F13-CLIM',\n '2A-SSMI-F14-CLIM',\n '2A-SSMI-F15-CLIM',\n '2A-SSMIS-F16',\n '2A-SSMIS-F16-CLIM',\n '2A-SSMIS-F17',\n '2A-SSMIS-F17-CLIM',\n '2A-SSMIS-F18',\n '2A-SSMIS-F18-CLIM',\n '2A-SSMIS-F19',\n '2A-SSMIS-F19-CLIM',\n '2A-TMI-CLIM',\n '2A-TRMM-SLH',\n '2B-GPM-CORRA',\n '2B-GPM-CSAT',\n '2B-GPM-CSH',\n '2B-TRMM-CORRA',\n '2B-TRMM-CSAT',\n '2B-TRMM-CSH',\n 'IMERG-FR']","content_type":"text/plain"}}}],"key":"rHs8N2p6QN"}],"key":"D8uRrgHzJ7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s have a look at the available RADAR products:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OTe5npK1Jb"}],"key":"Gz6cVdRpGt"}],"key":"Va2pNVBMJs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gpm.available_products(product_categories=\"RADAR\", product_levels=\"1B\")","key":"feQFF3pOlS"},{"type":"output","id":"clm4HSyJs3RM6-lLFlIuQ","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"['1B-Ka', '1B-Ku', '1B-PR']","content_type":"text/plain"}}}],"key":"SQzu5nu5iM"}],"key":"ycQSE2kxj8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gpm.available_products(product_categories=\"RADAR\", product_levels=\"2A\")","key":"p87PGH60mD"},{"type":"output","id":"eh5S2jtcSFTSQT8TsNmpn","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"['2A-DPR',\n '2A-ENV-DPR',\n '2A-ENV-Ka',\n '2A-ENV-Ku',\n '2A-ENV-PR',\n '2A-GPM-SLH',\n '2A-Ka',\n '2A-Ku',\n '2A-PR',\n '2A-TRMM-SLH']","content_type":"text/plain"}}}],"key":"WlLkH8qdDU"}],"key":"aYC1A8vJDd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this tutorial, we will use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cqggLMwizq"},{"type":"inlineCode","value":"2A-DPR","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T0jqYDLOAo"},{"type":"text","value":" product which provides the GPM Dual-frequency Precipitation Radar (DPR) reflectivities and associated precipitation retrievals.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DYeqAUWFfp"}],"key":"eNhMTWSicv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Since we are running this tutorial on a Binder environment, we will not execute the following ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w0vM0YXVC3"},{"type":"inlineCode","value":"gpm.download","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hah5i9oXV3"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qc6bsRaTms"},{"type":"inlineCode","value":"gpm.open_dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Xhz7W5VMWo"},{"type":"text","value":" sections, and directly load the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HkdEma6X4u"},{"type":"inlineCode","value":"2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.HDF5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kUXX2JCKue"},{"type":"text","value":" granule file,","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PIR70g9vqv"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Upgi7VaSLJ"},{"type":"text","value":"which has been preconverted to a Zarr Store and uploaded on the Pythia Cloud Bucket to simplify access to the data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cCR0lLOZvm"}],"key":"hzQ1zH9FGA"}],"key":"UlXCT83hT9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Download Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R1BWoUAUQb"}],"identifier":"id-1-download-data","label":"1. Download Data","html_id":"id-1-download-data","implicit":true,"key":"X1zq0rfF0s"}],"key":"JviZIMLroX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s download the 2A-DPR product over a couple of hours.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jfLz89vct1"}],"key":"CMUOjOa88d"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To download GPM data with GPM-API, you have to previously create a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OdWRfdaQ0a"},{"type":"link","url":"https://urs.earthdata.nasa.gov/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"NASA Earthdata","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CiNQsdRwnO"}],"urlSource":"https://urs.earthdata.nasa.gov/","key":"HgAIvN9T8a"},{"type":"text","value":" and/or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G6MtF9SNhk"},{"type":"link","url":"https://registration.pps.eosdis.nasa.gov/registration/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"NASA PPS","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UHqt5CcnVs"}],"urlSource":"https://registration.pps.eosdis.nasa.gov/registration/","key":"isqoasal54"},{"type":"text","value":" account.\nWe provide a step-by-step guide on how to set up your accounts in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DvkG4Bsa0R"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/03_quickstart.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"official GPM-API documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x7oX8isNvm"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/03_quickstart.html","key":"tE1xUw2DLm"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AzEpJxvHqK"}],"key":"gOwPYb7Yil"}],"key":"rcdQvuC2eq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Specify the time period you are interested in\nstart_time = datetime.datetime.strptime(\"2023-08-20 22:12:00\", \"%Y-%m-%d %H:%M:%S\")\nend_time = datetime.datetime.strptime(\"2023-08-20 22:13:45\", \"%Y-%m-%d %H:%M:%S\")\n# Specify the product and product type\nproduct = \"2A-DPR\"  # 2A-PR\nproduct_type = \"RS\"\nstorage = \"GES_DISC\"\n# Specify the version\nversion = 7","key":"k81R6avv1u"},{"type":"output","id":"bA-3AwIAVeRPqYRqfVVqP","data":[],"key":"uhao6OZPec"}],"key":"LAGFPoGJZx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Download the data\n\n# gpm.download(\n#     product=product,\n#     product_type=product_type,\n#     version=version,\n#     start_time=start_time,\n#     end_time=end_time,\n#     storage=storage,\n#     force_download=False,\n#     verbose=True,\n#     progress_bar=True,\n#     check_integrity=False,\n# )","key":"YXiM9Q8O8k"},{"type":"output","id":"fmPvR1z0Jr7JcOecJdS1f","data":[],"key":"muY1mCLUWT"}],"key":"HWpFwN4vuo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Once, the data are downloaded on disk, let’s load the 2A-DPR product and look at the dataset structure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WHlZ5jPH8m"}],"key":"IE6j338aQw"}],"key":"zqtyj3DE9T"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Load Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PvFO3EMUGk"}],"identifier":"id-2-load-data","label":"2. Load Data","html_id":"id-2-load-data","implicit":true,"key":"Qj6cx22S9X"}],"key":"lJEmWVSUke"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With GPM-API, the name granule is used to refer to a single file, while the name dataset is used to refer to a collection of granules.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yqjYXmNhcG"}],"key":"ja6mcg5HQG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GPM-API enables to open single or multiple granules into an xarray.Dataset, an object designed for working with labeled multi-dimensional arrays.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gt3CfuRAVB"}],"key":"VUhElAEVFo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p1p11xUn20"},{"type":"inlineCode","value":"gpm.open_granule(filepath)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lmXKJn70mX"},{"type":"text","value":" opens a single file into xarray by providing the path of the file of interest.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wyDr2fyBF2"}],"key":"ABHKjx16Mq"}],"key":"nH4eL1jxzL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WVfB7qOgP9"},{"type":"inlineCode","value":"gpm.open_dataset","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yOG01RVKgb"},{"type":"text","value":" function enables to open a collection of granules over a period of interest.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uuAmX5azKI"}],"key":"o4G2L0katd"}],"key":"v2q62GxgSM"}],"key":"imXSwC6zKW"}],"key":"e46zu2SpS7"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load the 2A-DPR dataset\n\n# ds = gpm.open_dataset(\n#     product=product,\n#     product_type=product_type,\n#     version=version,\n#     start_time=start_time,\n#     end_time=end_time,\n# )\n# ds","key":"qBYccqFfGj"},{"type":"output","id":"bw-ScPpLWWi6MR4GVKzf2","data":[],"key":"CXqdel4kyW"}],"key":"zD2QYzsig4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we directly read the data required for this tutorial from the Pythia Cloud Bucket so that you don’t have to register a NASA account and download the data beforehand.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vbjfzFyyEC"}],"key":"PxnagzYMDy"}],"key":"AoxM8GtzoA"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"bucket_url = \"https://js2.jetstream-cloud.org:8001\"\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=bucket_url))\nfile = fs.get_mapper(\n    f\"pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr\"\n)\nds = xr.open_zarr(file, consolidated=True, chunks={})","key":"gcK5fAajmZ"},{"type":"output","id":"wJ1U_7v07QpuT2NZ85fgJ","data":[],"key":"oDtu5mM0VL"}],"key":"M71fNcScJ6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Basic Manipulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TtbSGvDHDu"}],"identifier":"id-3-basic-manipulations","label":"3. Basic Manipulations","html_id":"id-3-basic-manipulations","implicit":true,"key":"zufaQIOK7K"}],"key":"djM6cN4Vlg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can list variables, coordinates and dimensions with the following methods:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dYqSnewl4Y"}],"key":"Lk4m7Sgv2k"}],"key":"rcydBXR86D"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Available variables\nprint(\"Available variables: \", list(ds.data_vars))\n# Available coordinates\nprint(\"Available coordinates: \", list(ds.coords))\n# Available dimensions\nprint(\"Available dimensions: \", list(ds.dims))\n# Spatial dimension:\nprint(\"Spatial dimensions: \", ds.gpm.spatial_dimensions)\n# Vertical dimension:\nprint(\"Vertical dimension: \", ds.gpm.vertical_dimension)","key":"vLRUcHKcfe"},{"type":"output","id":"yMba32a9gz8THxDyPt6Pn","data":[{"name":"stdout","output_type":"stream","text":"Available variables:  ['DFRforward1', 'Dm', 'FractionalGranuleNumber', 'MSindex', 'MSindexKa', 'MSindexKu', 'MSkneeDFRindex', 'MSslopesKa', 'MSslopesKu', 'MSsurfPeakIndexKa', 'MSsurfPeakIndexKu', 'NUBFindex', 'Nw', 'PIAalt', 'PIAdw', 'PIAhb', 'PIAhybrid', 'PIAweight', 'PIAweightHY', 'RFactorAlt', 'acsModeMidScan', 'adjustFactor', 'airTemperature', 'alongTrackBeamWidth', 'attenuationNP', 'binBBBottom', 'binBBPeak', 'binBBTop', 'binClutterFreeBottom', 'binDFRmMLBottom', 'binDFRmMLTop', 'binEchoBottom', 'binHeavyIcePrecipBottom', 'binHeavyIcePrecipTop', 'binMirrorImageL2', 'binMixedPhaseTop', 'binNode', 'binRealSurface', 'binStormTop', 'binZeroDeg', 'binZeroDegSecondary', 'crossTrackBeamWidth', 'dBNw', 'dataWarning', 'dprAlt', 'echoCountRealSurface', 'elevation', 'ellipsoidBinOffset', 'epsilon', 'flagAnvil', 'flagBB', 'flagEcho', 'flagGraupelHail', 'flagHail', 'flagHeavyIcePrecip', 'flagInversion', 'flagMLquality', 'flagPrecip', 'flagSLV', 'flagScanPattern', 'flagSensor', 'flagShallowRain', 'flagSigmaZeroSaturation', 'flagSurfaceSnowfall', 'geoError', 'geoWarning', 'greenHourAng', 'heightBB', 'heightStormTop', 'heightZeroDeg', 'landSurfaceType', 'limitErrorFlag', 'localZenithAngle', 'missing', 'modeStatus', 'nHeavyIcePrecip', 'operationalMode', 'paramNUBF', 'paramRDm', 'pathAtten', 'phase', 'phaseNearSurface', 'piaExp', 'piaFinal', 'piaNP', 'piaNPrainFree', 'piaOffset', 'pointingStatus', 'precipRate', 'precipRateAve24', 'precipRateESurface', 'precipRateESurface2', 'precipRateESurface2Status', 'precipRateNearSurface', 'precipWater', 'precipWaterIntegrated', 'precipWaterIntegrated_Liquid', 'precipWaterIntegrated_Solid', 'qualityBB', 'qualityData', 'qualityFlag', 'qualitySLV', 'qualityTypePrecip', 'range_distance_from_satellite', 'refScanID', 'reliabFactor', 'reliabFactorHY', 'reliabFlag', 'reliabFlagHY', 'scAlt', 'scAttPitchGeoc', 'scAttPitchGeod', 'scAttRollGeoc', 'scAttRollGeod', 'scAttYawGeoc', 'scAttYawGeod', 'scHeadingGround', 'scHeadingOrbital', 'scLat', 'scLon', 'scPos', 'scVel', 'seaIceConcentration', 'sigmaZeroCorrected', 'sigmaZeroMeasured', 'sigmaZeroNPCorrected', 'sigmaZeroProfile', 'snRatioAtRealSurface', 'snowIceCover', 'stddevEff', 'stddevHY', 'surfaceSnowfallIndex', 'targetSelectionMidScan', 'timeMidScan', 'timeMidScanOffset', 'typePrecip', 'widthBB', 'zFactorFinal', 'zFactorFinalESurface', 'zFactorFinalNearSurface', 'zFactorMeasured', 'zeta']\nAvailable coordinates:  ['DSD_params', 'SCorientation', 'crsWGS84', 'dataQuality', 'gpm_along_track_id', 'gpm_cross_track_id', 'gpm_granule_id', 'gpm_id', 'gpm_range_id', 'height', 'lat', 'lon', 'radar_frequency', 'range', 'sunLocalTime', 'time']\nAvailable dimensions:  ['cross_track', 'along_track', 'range', 'DSD_params', 'four', 'method', 'radar_frequency', 'three', 'nfreqHI', 'nNode', 'nNUBF', 'nNP', 'foreBack', 'nearFar', 'XYZ', 'nbinSZP', 'nsdew']\nSpatial dimensions:  ['along_track', 'cross_track']\nVertical dimension:  ['range']\n"}],"key":"aa20WZl0k1"}],"key":"zlSaEtGkHF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Through the use of the xarray ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tbjrqpqh7Y"},{"type":"inlineCode","value":"gpm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y7zTor9ddt"},{"type":"text","value":" accessor, you can access various methods that simplify for example the listing of variables according to their dimensions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x4XoFBWaar"}],"key":"GuVKegWZdu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"For example, using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RZdDCXzxXj"},{"type":"inlineCode","value":"ds.gpm.spatial_3d_variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qxWohXO7i6"},{"type":"text","value":" you can list all dataset variables with spatial horizontal and vertical dimensions, while with\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IDzaaXTzvS"},{"type":"inlineCode","value":"ds.gpm.spatial_2d_variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HdeOUc1agV"},{"type":"text","value":" you can list all dataset variables with only spatial horizontal dimensions.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bVLq9PK8t8"}],"key":"Qofgz9MMJY"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To directly obtain a dataset with the variables of interest, you can also call the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Qqka5oY3de"},{"type":"inlineCode","value":"ds.gpm.select_spatial_2d_variables","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SUGvhuNnHy"},{"type":"text","value":" or ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ptdDmL0JH4"},{"type":"inlineCode","value":"ds.gpm.select_spatial_3d_variables","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MIGZZM68Yo"},{"type":"text","value":"  methods.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bRXl3PO8Ia"}],"key":"Io5LPCK77L"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Please keep in mind that to create a spatial map, it is necessary to select spatial 2D variables, while for extracting vertical cross-sections it is necessary to slice across spatial 3D variables.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Mi5iQGNidB"}],"key":"sKEmbUfPpy"}],"key":"zoNqyXCv5R"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds.gpm.spatial_2d_variables)\nds.gpm.select_spatial_2d_variables()","key":"RNough2rUZ"},{"type":"output","id":"mQkN4DbDozxRcQNF-Hg78","data":[{"name":"stdout","output_type":"stream","text":"['MSindex', 'MSindexKa', 'MSindexKu', 'MSkneeDFRindex', 'MSslopesKa', 'MSslopesKu', 'MSsurfPeakIndexKa', 'MSsurfPeakIndexKu', 'NUBFindex', 'PIAalt', 'PIAdw', 'PIAhb', 'PIAhybrid', 'PIAweight', 'PIAweightHY', 'RFactorAlt', 'adjustFactor', 'alongTrackBeamWidth', 'binBBBottom', 'binBBPeak', 'binBBTop', 'binClutterFreeBottom', 'binDFRmMLBottom', 'binDFRmMLTop', 'binEchoBottom', 'binHeavyIcePrecipBottom', 'binHeavyIcePrecipTop', 'binMirrorImageL2', 'binMixedPhaseTop', 'binNode', 'binRealSurface', 'binStormTop', 'binZeroDeg', 'binZeroDegSecondary', 'crossTrackBeamWidth', 'echoCountRealSurface', 'elevation', 'ellipsoidBinOffset', 'flagAnvil', 'flagBB', 'flagGraupelHail', 'flagHail', 'flagHeavyIcePrecip', 'flagInversion', 'flagMLquality', 'flagPrecip', 'flagShallowRain', 'flagSigmaZeroSaturation', 'flagSurfaceSnowfall', 'heightBB', 'heightStormTop', 'heightZeroDeg', 'landSurfaceType', 'localZenithAngle', 'nHeavyIcePrecip', 'paramNUBF', 'paramRDm', 'pathAtten', 'phaseNearSurface', 'piaExp', 'piaFinal', 'piaNP', 'piaNPrainFree', 'piaOffset', 'precipRateAve24', 'precipRateESurface', 'precipRateESurface2', 'precipRateESurface2Status', 'precipRateNearSurface', 'precipWaterIntegrated', 'precipWaterIntegrated_Liquid', 'precipWaterIntegrated_Solid', 'qualityBB', 'qualityData', 'qualityFlag', 'qualitySLV', 'qualityTypePrecip', 'refScanID', 'reliabFactor', 'reliabFactorHY', 'reliabFlag', 'reliabFlagHY', 'seaIceConcentration', 'sigmaZeroCorrected', 'sigmaZeroMeasured', 'sigmaZeroNPCorrected', 'sigmaZeroProfile', 'snRatioAtRealSurface', 'snowIceCover', 'stddevEff', 'stddevHY', 'surfaceSnowfallIndex', 'typePrecip', 'widthBB', 'zFactorFinalESurface', 'zFactorFinalNearSurface', 'zeta']\n"},{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"0af4868e54c1890009e3e06f8d55f504","path":"/ams2025/_preview/2/build/0af4868e54c1890009e3e06f8d55f504.html"},"text/plain":{"content":"<xarray.Dataset> Size: 336MB\nDimensions:                       (cross_track: 49, along_track: 7932, four: 4,\n                                   method: 6, radar_frequency: 2, three: 3,\n                                   nfreqHI: 3, nNode: 5, nNUBF: 3, nNP: 4,\n                                   foreBack: 2, nearFar: 2, nbinSZP: 7, nsdew: 3)\nCoordinates:\n    SCorientation                 (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84                      int64 8B ...\n    dataQuality                   (along_track, radar_frequency) float32 63kB dask.array<chunksize=(7932, 2), meta=np.ndarray>\n    gpm_along_track_id            (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id            (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id                (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_id                        (along_track) <U10 317kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    lat                           (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                           (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n  * radar_frequency               (radar_frequency) <U2 16B 'Ku' 'Ka'\n    sunLocalTime                  (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                          (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track, four, method, three,\n                                nfreqHI, nNode, nNUBF, nNP, foreBack, nearFar,\n                                nbinSZP, nsdew\nData variables: (12/97)\n    MSindex                       (cross_track, along_track) float64 3MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    MSindexKa                     (cross_track, along_track) float64 3MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    MSindexKu                     (cross_track, along_track) float64 3MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    MSkneeDFRindex                (cross_track, along_track) float64 3MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    MSslopesKa                    (cross_track, along_track, four) float32 6MB dask.array<chunksize=(49, 500, 4), meta=np.ndarray>\n    MSslopesKu                    (cross_track, along_track, four) float32 6MB dask.array<chunksize=(49, 500, 4), meta=np.ndarray>\n    ...                            ...\n    surfaceSnowfallIndex          (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    typePrecip                    (cross_track, along_track) float64 3MB dask.array<chunksize=(49, 500), meta=np.ndarray>\n    widthBB                       (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    zFactorFinalESurface          (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    zFactorFinalNearSurface       (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    zeta                          (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"edH4x0CaCe"}],"key":"UNrdd22s52"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds.gpm.spatial_3d_variables)\nds.gpm.select_spatial_3d_variables()","key":"rFojNFTRw6"},{"type":"output","id":"TNSd_J3jsZp2wrSMWN3LH","data":[{"name":"stdout","output_type":"stream","text":"['DFRforward1', 'Dm', 'Nw', 'airTemperature', 'attenuationNP', 'dBNw', 'epsilon', 'flagEcho', 'flagSLV', 'phase', 'precipRate', 'precipWater', 'range_distance_from_satellite', 'zFactorFinal', 'zFactorMeasured']\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"ec0d206da3ca08ff9ff4b827e7c12c30","path":"/ams2025/_preview/2/build/ec0d206da3ca08ff9ff4b827e7c12c30.html"},"text/plain":{"content":"<xarray.Dataset> Size: 5GB\nDimensions:                        (cross_track: 49, along_track: 7932,\n                                    range: 176, radar_frequency: 2)\nCoordinates: (12/15)\n    SCorientation                  (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84                       int64 8B ...\n    dataQuality                    (along_track, radar_frequency) float32 63kB dask.array<chunksize=(7932, 2), meta=np.ndarray>\n    gpm_along_track_id             (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id             (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id                 (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    ...                             ...\n    lat                            (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                            (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n  * radar_frequency                (radar_frequency) <U2 16B 'Ku' 'Ka'\n  * range                          (range) int64 1kB 1 2 3 4 ... 173 174 175 176\n    sunLocalTime                   (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                           (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track\nData variables: (12/15)\n    DFRforward1                    (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    Dm                             (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    Nw                             (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    airTemperature                 (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    attenuationNP                  (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\n    dBNw                           (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    ...                             ...\n    phase                          (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    precipRate                     (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    precipWater                    (cross_track, along_track, range) float32 274MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    range_distance_from_satellite  (cross_track, along_track, range) float64 547MB dask.array<chunksize=(49, 500, 176), meta=np.ndarray>\n    zFactorFinal                   (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\n    zFactorMeasured                (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"PEYCGmJnGK"}],"key":"PiOOFuiHhp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some variables also have a frequency dimension. You can list or subset such variables using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OiEj4d8PE4"},{"type":"inlineCode","value":"ds.gpm.frequency_variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LxeoFeJxOX"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tz51Bpso8X"},{"type":"inlineCode","value":"ds.gpm.'select_frequency_variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aasgNhjqDm"},{"type":"text","value":" respectively.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uReaxDvIK6"}],"key":"st02Kjntxv"}],"key":"SRFAbIFokO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds.gpm.frequency_variables)\nds.gpm.select_frequency_variables()","key":"chmBqJK2xn"},{"type":"output","id":"wX7I231fTlhm83TpzU-Of","data":[{"name":"stdout","output_type":"stream","text":"['PIAalt', 'PIAdw', 'PIAhb', 'PIAhybrid', 'adjustFactor', 'attenuationNP', 'binRealSurface', 'dataWarning', 'echoCountRealSurface', 'flagScanPattern', 'flagSensor', 'flagSigmaZeroSaturation', 'geoError', 'geoWarning', 'limitErrorFlag', 'localZenithAngle', 'missing', 'modeStatus', 'operationalMode', 'pathAtten', 'piaExp', 'piaFinal', 'piaNP', 'piaNPrainFree', 'piaOffset', 'pointingStatus', 'qualityFlag', 'sigmaZeroCorrected', 'sigmaZeroMeasured', 'sigmaZeroNPCorrected', 'sigmaZeroProfile', 'snRatioAtRealSurface', 'stddevEff', 'stddevHY', 'zFactorFinal', 'zFactorFinalESurface', 'zFactorFinalNearSurface', 'zFactorMeasured', 'zeta']\n"},{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"3c3dc5f546ba533d3a0b15f8d79d0c80","path":"/ams2025/_preview/2/build/3c3dc5f546ba533d3a0b15f8d79d0c80.html"},"text/plain":{"content":"<xarray.Dataset> Size: 2GB\nDimensions:                  (cross_track: 49, along_track: 7932, method: 6,\n                              radar_frequency: 2, range: 176, nNP: 4,\n                              nbinSZP: 7, nsdew: 3)\nCoordinates: (12/15)\n    SCorientation            (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84                 int64 8B ...\n    dataQuality              (along_track, radar_frequency) float32 63kB dask.array<chunksize=(7932, 2), meta=np.ndarray>\n    gpm_along_track_id       (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id       (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id           (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    ...                       ...\n    lat                      (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                      (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n  * radar_frequency          (radar_frequency) <U2 16B 'Ku' 'Ka'\n  * range                    (range) int64 1kB 1 2 3 4 5 ... 172 173 174 175 176\n    sunLocalTime             (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                     (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track, method, nNP, nbinSZP,\n                                nsdew\nData variables: (12/39)\n    PIAalt                   (cross_track, along_track, method, radar_frequency) float32 19MB dask.array<chunksize=(49, 500, 6, 2), meta=np.ndarray>\n    PIAdw                    (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    PIAhb                    (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    PIAhybrid                (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    adjustFactor             (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    attenuationNP            (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\n    ...                       ...\n    stddevHY                 (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    zFactorFinal             (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\n    zFactorFinalESurface     (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    zFactorFinalNearSurface  (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\n    zFactorMeasured          (cross_track, along_track, range, radar_frequency) float32 547MB dask.array<chunksize=(49, 500, 176, 2), meta=np.ndarray>\n    zeta                     (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(49, 500, 2), meta=np.ndarray>\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"VyfFMa8yIw"}],"key":"k252NLBUjR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B6loMWMjaZ"},{"type":"inlineCode","value":"ds.gpm.bin_variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nsKcGPpfK6"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LUxvWa3P3K"},{"type":"inlineCode","value":"ds.gpm.select_bin_variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fYJe3fhI1k"},{"type":"text","value":" you can instead list or select the variables that contains “pointers” to specific radar gates.\nThe bin variables are useful to slice or extract data across the “range” dimension of the dataset.\nBin variables values range from 1 (the ellipsoid surface) to the size of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lmOg8DPXuw"},{"type":"inlineCode","value":"range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jl56a0X3tC"},{"type":"text","value":" dimension (in the upper atmosphere).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JRrFCocNk4"}],"key":"JPlUY7i2m2"}],"key":"XiaPUzk3Ay"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds.gpm.bin_variables)\nds.gpm.select_bin_variables()","key":"XI3xiwAXBp"},{"type":"output","id":"BtPp5VqNC0RNhmnmDzAGm","data":[{"name":"stdout","output_type":"stream","text":"['binBBBottom', 'binBBPeak', 'binBBTop', 'binClutterFreeBottom', 'binDFRmMLBottom', 'binDFRmMLTop', 'binEchoBottom', 'binHeavyIcePrecipBottom', 'binHeavyIcePrecipTop', 'binMirrorImageL2', 'binMixedPhaseTop', 'binNode', 'binRealSurface', 'binStormTop', 'binZeroDeg', 'binZeroDegSecondary']\n"},{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"72bdb6a31d4758cfd4581a415218ba57","path":"/ams2025/_preview/2/build/72bdb6a31d4758cfd4581a415218ba57.html"},"text/plain":{"content":"<xarray.Dataset> Size: 44MB\nDimensions:                  (cross_track: 49, along_track: 7932, nfreqHI: 3,\n                              nNode: 5, radar_frequency: 2)\nCoordinates:\n    SCorientation            (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84                 int64 8B ...\n    dataQuality              (along_track, radar_frequency) float32 63kB dask.array<chunksize=(7932, 2), meta=np.ndarray>\n    gpm_along_track_id       (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id       (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id           (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_id                   (along_track) <U10 317kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    lat                      (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                      (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n  * radar_frequency          (radar_frequency) <U2 16B 'Ku' 'Ka'\n    sunLocalTime             (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                     (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track, nfreqHI, nNode\nData variables: (12/16)\n    binBBBottom              (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binBBPeak                (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binBBTop                 (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binClutterFreeBottom     (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binDFRmMLBottom          (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binDFRmMLTop             (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    ...                       ...\n    binMixedPhaseTop         (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binNode                  (cross_track, along_track, nNode) float32 8MB dask.array<chunksize=(13, 3966, 3), meta=np.ndarray>\n    binRealSurface           (cross_track, along_track, radar_frequency) float32 3MB dask.array<chunksize=(25, 3966, 1), meta=np.ndarray>\n    binStormTop              (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binZeroDeg               (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    binZeroDegSecondary      (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"CjwgaG4q42"}],"key":"gGnwwPOsJ5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To select the DataArray corresponding to a single variable you do:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cNuYzjKyuK"}],"key":"a4lGEOn5jg"}],"key":"A3S16WjO55"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"variable = \"precipRateNearSurface\"\nda = ds[variable]\nprint(\" Array Class: \", type(da.data))\nda","key":"EBth1nSmbn"},{"type":"output","id":"3bLzVxexEbyLmAW_OWWXv","data":[{"name":"stdout","output_type":"stream","text":" Array Class:  <class 'dask.array.core.Array'>\n"},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"4548ede2d56f28dc24a0570ebf065000","path":"/ams2025/_preview/2/build/4548ede2d56f28dc24a0570ebf065000.html"},"text/plain":{"content":"<xarray.DataArray 'precipRateNearSurface' (cross_track: 49, along_track: 7932)> Size: 2MB\ndask.array<open_dataset-precipRateNearSurface, shape=(49, 7932), dtype=float32, chunksize=(49, 500), chunktype=numpy.ndarray>\nCoordinates:\n    SCorientation       (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84            int64 8B ...\n    gpm_along_track_id  (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id  (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id      (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_id              (along_track) <U10 317kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    lat                 (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                 (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    sunLocalTime        (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track\nAttributes:\n    gpm_api_product:  2A-DPR\n    grid_mapping:     crsWGS84\n    units:            mm/hr","content_type":"text/plain"}}}],"key":"u3WJ4Mk8Ha"}],"key":"fejya617f5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"If the array class is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mb5Uzljd5G"},{"type":"inlineCode","value":"dask.Array","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y3dFIbgwqu"},{"type":"text","value":", it means that the data are not yet loaded into RAM memory.\nTo put the data into memory, you need to call the method ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EDj2aFO73k"},{"type":"inlineCode","value":"compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FGQa81Y4JX"},{"type":"text","value":", either on the xarray object or on the numerical array.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lG67jvDGct"}],"key":"JEd6oTid4q"}],"key":"bqSeubJsn6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"da = da.compute()\nprint(\"Array Class: \", type(da.data))\nda","key":"yjiPZiF2PU"},{"type":"output","id":"YwE_DiFgQzRkSbkk45G2R","data":[{"name":"stdout","output_type":"stream","text":"Array Class:  <class 'numpy.ndarray'>\n"},{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d703ef847e06ad731bb65aa50c590bd9","path":"/ams2025/_preview/2/build/d703ef847e06ad731bb65aa50c590bd9.html"},"text/plain":{"content":"<xarray.DataArray 'precipRateNearSurface' (cross_track: 49, along_track: 7932)> Size: 2MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)\nCoordinates:\n    SCorientation       (along_track) float32 32kB 0.0 0.0 0.0 ... 0.0 0.0 0.0\n    crsWGS84            int64 8B 0\n    gpm_along_track_id  (along_track) int64 63kB 0 1 2 3 ... 7928 7929 7930 7931\n    gpm_cross_track_id  (cross_track) int64 392B 0 1 2 3 4 5 ... 44 45 46 47 48\n    gpm_granule_id      (along_track) int64 63kB 53847 53847 ... 53847 53847\n    gpm_id              (along_track) <U10 317kB '53847-0' ... '53847-7931'\n    lat                 (cross_track, along_track) float32 2MB -63.96 ... -66.26\n    lon                 (cross_track, along_track) float32 2MB 142.2 ... 118.7\n    sunLocalTime        (cross_track, along_track) float32 2MB 7.085 ... 7.06\n    time                (along_track) datetime64[ns] 63kB 2023-08-20T21:39:42...\nDimensions without coordinates: cross_track, along_track\nAttributes:\n    gpm_api_product:  2A-DPR\n    grid_mapping:     crsWGS84\n    units:            mm/hr","content_type":"text/plain"}}}],"key":"qB380eaXJK"}],"key":"P0foCCol5l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To check if the Dataset or the DataArray you selected has only spatial horizontal and/or vertical dimensions, you can use the xarray accessor ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IohpXd57mS"},{"type":"inlineCode","value":"gpm.is_spatial_2d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sIUDasZy3H"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"grUb8IYNMl"},{"type":"inlineCode","value":"gpm.is_spatial_3d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y5R6s927JQ"},{"type":"text","value":" properties.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bNWljmdQ5Z"}],"key":"TkfVWc40Zc"}],"key":"yGZRow2Dtb"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\n    ds.gpm.is_spatial_2d\n)  # False because the xarray.Dataset also contains the range and frequency dimensions !\nprint(\n    ds.gpm.is_spatial_3d\n)  # False because the xarray.Dataset also contains frequency dimensions !","key":"MMf5ibiItO"},{"type":"output","id":"TPEUojU63CnY--xZBBy-I","data":[{"name":"stdout","output_type":"stream","text":"False\nFalse\n"}],"key":"Mf0Z9z9UAO"}],"key":"Uw8QosZDqn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\n    ds[\"zFactorFinal\"].isel(range=0).sel(radar_frequency=\"Ka\").gpm.is_spatial_2d\n)  # True\nprint(ds[\"precipRateNearSurface\"].gpm.is_spatial_2d)","key":"V1LRbG33Hl"},{"type":"output","id":"DXfuupO1x_5OncgE2eUqP","data":[{"name":"stdout","output_type":"stream","text":"True\nTrue\n"}],"key":"oNE8lHMHGa"}],"key":"KEBwCw0oua"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can select the reflectivity volumes at a given frequency using the radar band name with the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fz8QE0Qedq"},{"type":"inlineCode","value":"sel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SlL3anQKPR"},{"type":"text","value":" method:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Apy37CoynG"}],"key":"hAK0yJOIZF"}],"key":"KBBQeiLf2S"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds[\"zFactorFinal\"].sel(radar_frequency=\"Ka\")","key":"bN3v1o0RST"},{"type":"output","id":"hFL-ENayHD7EZpce3pQdm","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"f29f733235099b4b0051a84f29a2f1d1","path":"/ams2025/_preview/2/build/f29f733235099b4b0051a84f29a2f1d1.html"},"text/plain":{"content":"<xarray.DataArray 'zFactorFinal' (cross_track: 49, along_track: 7932, range: 176)> Size: 274MB\ndask.array<getitem, shape=(49, 7932, 176), dtype=float32, chunksize=(49, 500, 176), chunktype=numpy.ndarray>\nCoordinates: (12/15)\n    SCorientation       (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    crsWGS84            int64 8B ...\n    dataQuality         (along_track) float32 32kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_along_track_id  (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    gpm_cross_track_id  (cross_track) int64 392B dask.array<chunksize=(49,), meta=np.ndarray>\n    gpm_granule_id      (along_track) int64 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\n    ...                  ...\n    lat                 (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    lon                 (cross_track, along_track) float32 2MB dask.array<chunksize=(49, 7932), meta=np.ndarray>\n    radar_frequency     <U2 8B 'Ka'\n  * range               (range) int64 1kB 1 2 3 4 5 6 ... 172 173 174 175 176\n    sunLocalTime        (cross_track, along_track) float32 2MB dask.array<chunksize=(25, 3966), meta=np.ndarray>\n    time                (along_track) datetime64[ns] 63kB dask.array<chunksize=(7932,), meta=np.ndarray>\nDimensions without coordinates: cross_track, along_track\nAttributes:\n    gpm_api_product:  2A-DPR\n    grid_mapping:     crsWGS84\n    units:            dBZ","content_type":"text/plain"}}}],"key":"ku1Hv6uWj6"}],"key":"gmZU27VCnb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since xarray does not yet allow subsetting by value along non-dimensional coordinates, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KRWy4HYCGs"},{"type":"inlineCode","value":"gpm.sel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iVRQQNOIgt"},{"type":"text","value":" method provides you this functionality.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQm4np8Khl"}],"key":"aOjoaAc8MN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As an example, you can subset the dataset by time:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NUDl65jWKM"}],"key":"a2yP3HrKL9"}],"key":"Yq5CzxdkJv"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"start_time = datetime.datetime.strptime(\"2023-08-20 22:12:00\", \"%Y-%m-%d %H:%M:%S\")\nend_time = datetime.datetime.strptime(\"2023-08-20 22:13:45\", \"%Y-%m-%d %H:%M:%S\")\nds_subset = ds.gpm.sel(time=slice(start_time, end_time))\nds_subset[\"time\"]","key":"REu7JqUSUy"},{"type":"output","id":"TuBVFHvnJ4Glc_Flw8YO0","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"e467b54f38f0176d09f4eaeb05ec68bc","path":"/ams2025/_preview/2/build/e467b54f38f0176d09f4eaeb05ec68bc.html"},"text/plain":{"content":"<xarray.DataArray 'time' (along_track: 151)> Size: 1kB\ndask.array<getitem, shape=(151,), dtype=datetime64[ns], chunksize=(151,), chunktype=numpy.ndarray>\nCoordinates:\n    SCorientation       (along_track) float32 604B dask.array<chunksize=(151,), meta=np.ndarray>\n    crsWGS84            int64 8B ...\n    gpm_along_track_id  (along_track) int64 1kB dask.array<chunksize=(151,), meta=np.ndarray>\n    gpm_granule_id      (along_track) int64 1kB dask.array<chunksize=(151,), meta=np.ndarray>\n    gpm_id              (along_track) <U10 6kB dask.array<chunksize=(151,), meta=np.ndarray>\n    time                (along_track) datetime64[ns] 1kB dask.array<chunksize=(151,), meta=np.ndarray>\nDimensions without coordinates: along_track\nAttributes:\n    axis:                   T\n    coverage_content_type:  coordinate\n    standard_name:          time","content_type":"text/plain"}}}],"key":"jZEZLxKTxQ"}],"key":"n3nwjaSvkl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Remember that you can get the start time and end time of your GPM xarray object with the gpm accessor methods ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CtEj0gTbIC"},{"type":"inlineCode","value":"start_time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SpprGwdrX9"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KuWjfEn9G4"},{"type":"inlineCode","value":"end_time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wFYNBZA3Ub"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z96qxr14yI"}],"key":"hRjWG0B3NX"}],"key":"YExi1FgVIM"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds_subset.gpm.start_time)\nprint(ds_subset.gpm.end_time)","key":"NuKaXg9YXY"},{"type":"output","id":"xpOdyNgAhLzAjuPD3KhdZ","data":[{"name":"stdout","output_type":"stream","text":"2023-08-20 22:12:00\n2023-08-20 22:13:45\n"}],"key":"c0BuT8MmGp"}],"key":"dXNP5cZa4h"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can also subset your GPM xarray object by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFqcGA1Xj8"},{"type":"inlineCode","value":"gpm_id","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CI6KedbW7F"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjVQyGZjhN"},{"type":"inlineCode","value":"gpm_cross_track_id","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A2cPQ7tzss"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bweMXVkmci"},{"type":"inlineCode","value":"gpm_range_id","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jxm86CsEwW"},{"type":"text","value":" coordinates, which act as reference identifiers for the along-track, cross-track and range dimensions.\nSelecting across coordinates by value is useful for example to:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"StvZFYPhSn"}],"key":"oAm0WttHLn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"align multiple GPM xarray objects that might have been subsetted differently across the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YcFdUrLpMq"},{"type":"inlineCode","value":"cross_track","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wuXtK09PXz"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j3xK9R1p5O"},{"type":"inlineCode","value":"along_track","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zMu94M5dbQ"},{"type":"text","value":" or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Oxo6xB84MJ"},{"type":"inlineCode","value":"range","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CL7K2ETq0D"},{"type":"text","value":" dimensions.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wlk4IEoQnm"}],"key":"x2PC3qU1s4"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"to retrieve a specific portion of a GPM granule indipendently of the previous subsetting operations.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"F1fObIUX20"}],"key":"Xq4O6UoJ3B"}],"key":"ZkFG6ROieq"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Bwt5DuuLGB"},{"type":"inlineCode","value":"gpm_id","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SSjG7Kuref"},{"type":"text","value":" is defined as ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HbBSdeL4QX"},{"type":"inlineCode","value":"<gpm_granule_number>-<gpm_along_track_id>","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"d2P6KTPIha"},{"type":"text","value":", while the others <gpm_*_id> coordinates start at 0 and increase incrementally by 1 along each granule dimension.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EEfubRb5zy"}],"key":"XWNlT2i9M5"}],"key":"HID00BfXWE"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Subset by gpm_id\nstart_gpm_id = \"53847-2768\"\nend_gpm_id = \"53847-2918\"\nds_subset = ds.gpm.sel(gpm_id=slice(start_gpm_id, end_gpm_id))\nds_subset[\"gpm_id\"].data","key":"iA3RSKxxZl"},{"type":"output","id":"YqCy-TiZ8MvmqhaIluq_d","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 5.90 kiB </td>\n                        <td> 5.90 kiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (151,) </td>\n                        <td> (151,) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 1 chunks in 3 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> <U10 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >151</text>\n  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n</svg>\n        </td>\n    </tr>\n</table>","content_type":"text/html"},"text/plain":{"content":"dask.array<getitem, shape=(151,), dtype=<U10, chunksize=(151,), chunktype=numpy.ndarray>","content_type":"text/plain"}}}],"key":"xXMzU5BARo"}],"key":"veH35PIdNQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To check whether the GPM 2A-DPR product has contiguous along-track scans (with no missing scans), you can use:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drbp8BJCBZ"}],"key":"sCyPBKOLpR"}],"key":"WzQOMI7k0x"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(ds.gpm.has_contiguous_scans)\nprint(ds.gpm.is_regular)","key":"ZjYok1pMz4"},{"type":"output","id":"bIUXiQYSdfl5v3GMCkwmh","data":[{"name":"stdout","output_type":"stream","text":"True\nTrue\n"}],"key":"SpVrw0kQLY"}],"key":"Ilj1oAmjyR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In case there are non-contiguous scans, you can obtain the along-track slices over which the dataset is regular:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SuerIALfgr"}],"key":"pQ46ljcarf"}],"key":"kxk1MkBd5I"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"list_slices = ds.gpm.get_slices_contiguous_scans()\nprint(list_slices)","key":"fupI7FP5zI"},{"type":"output","id":"UXtVe_NglyHwLBMhEXsi1","data":[{"name":"stdout","output_type":"stream","text":"[slice(0, 7932, None)]\n"}],"key":"Sgqhtc0vrP"}],"key":"Icg0TFsWqo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can then select a regular portion of the dataset with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rCOOwwUFzB"}],"key":"Y07RpDqoQD"}],"key":"f8TbIKSTYq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"slc = list_slices[0]\nprint(slc)\nds_regular = ds.isel(along_track=slc)","key":"aQ2JVJA7zF"},{"type":"output","id":"YYw3PSpgzz2_3d_Ti7gsV","data":[{"name":"stdout","output_type":"stream","text":"slice(0, 7932, None)\n"}],"key":"f9iSdV9J5y"}],"key":"P8bAq3uz41"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Plot Maps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fkYVB4D5xH"}],"identifier":"id-4-plot-maps","label":"4. Plot Maps","html_id":"id-4-plot-maps","implicit":true,"key":"VlyX9KEteO"}],"key":"HGtMtUEdYQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The GPM-API provides two ways of displaying 2D spatial fields:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZRXaAtfX7W"}],"key":"yBWgXFdCMU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dwnbp4lBBt"},{"type":"inlineCode","value":"plot_map","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hmF7fuvL29"},{"type":"text","value":" method plot the data in a geographic projection using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"A7Pfx3yhF4"},{"type":"link","url":"https://scitools.org.uk/cartopy/docs/latest/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Cartopy","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KAI3noXnPj"}],"urlSource":"https://scitools.org.uk/cartopy/docs/latest/","key":"ZvOnwuRM8d"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"L2sxp4dnBY"},{"type":"inlineCode","value":"pcolormesh","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IYDCufpiw6"},{"type":"text","value":" method.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AjjPLtfeTw"}],"key":"defB7kGrFJ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H7GkklHPrv"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XPg50Cn8e0"},{"type":"text","value":" method plot the data as an image using the xarray ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qwVbWgyfh1"},{"type":"inlineCode","value":"imshow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gnvNB4MOvR"},{"type":"text","value":" method.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IlnQUFAQNy"}],"key":"VnNabzIAXn"}],"key":"vTp1Hs686G"}],"key":"W3Tusddj5H"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s start by plotting the entire GPM DPR granule in the geographic space:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ejXoPU6vRN"}],"key":"VikMq0u6jX"}],"key":"AFTLJ6BVri"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds[variable].gpm.plot_map()","key":"vExIzQ0WxB"},{"type":"output","id":"8rtH1xBlpehByPA6mu0P2","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbba0684d50>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b649f3bf0ef4dffa0a00e1cde19934c6","path":"/ams2025/_preview/2/build/b649f3bf0ef4dffa0a00e1cde19934c6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"mQWIqPUZDO"}],"key":"QBgTXx8ih9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By focusing on a narrow region, it’s possible to better visualize the spatial field:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zwokElc6ou"}],"key":"zLXnk8ssGe"}],"key":"nlGyb0Rmmu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"p = ds[variable].gpm.sel(gpm_id=slice(start_gpm_id, end_gpm_id)).gpm.plot_map()\np.axes.set_title(ds[variable].gpm.title(add_timestep=False))","key":"YWuWngI42V"},{"type":"output","id":"oGP2GXPHQpZ1XsGuQMxmG","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"091950bf07bdcbb8600ea3c56223c42e","path":"/ams2025/_preview/2/build/091950bf07bdcbb8600ea3c56223c42e.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"CGfms905sw"}],"key":"W8ccW7uqmg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GDG3zESUBp"},{"type":"inlineCode","value":"gpm.plot_image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KOVjShaHEI"},{"type":"text","value":" method is possible to visualize the data in the so-called “swath scan view”:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gxp5e2Bhj1"}],"key":"IkGgLH1kKt"}],"key":"nkOJ5lwdaI"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds[variable].gpm.plot_image()","key":"pq9mEoz0vC"},{"type":"output","id":"SihmxgphGwgPpYehQ58Pj","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9bcd9837ac8157e611cc80925fb99bf0","path":"/ams2025/_preview/2/build/9bcd9837ac8157e611cc80925fb99bf0.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"MzdsQiV0TH"}],"key":"pQ18xVnf7Y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds[variable].gpm.sel(gpm_id=slice(start_gpm_id, end_gpm_id)).gpm.plot_image()","key":"kMww8AE7cX"},{"type":"output","id":"qGf2Keetw7uBKPiVTBSVR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ad7950038d97b15dc9af61069e01603","path":"/ams2025/_preview/2/build/0ad7950038d97b15dc9af61069e01603.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"MGIOEAf8K5"}],"key":"hmCVHTaViK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When we visualize different product variables, GPM-API will automatically try to use different appropriate colormaps and colorbars.\nYou can observe this in the following example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LHj1TL60gM"}],"key":"oz24VLpPi1"}],"key":"VoptHSldOA"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset = ds.gpm.sel(gpm_id=slice(start_gpm_id, end_gpm_id), radar_frequency=\"Ku\")\np = ds_subset[\"zFactorFinalNearSurface\"].gpm.plot_map()\np = ds_subset[\"zFactorFinalNearSurface\"].gpm.plot_map(\n    cmap=\"RdYlBu_r\", vmin=15, vmax=45\n)  # ex: enable to modify defaults parameters on the fly\np = ds_subset[\"flagPrecip\"].gpm.plot_map()  # ex: defaults to categorical colorbar","key":"tERykR2ZaT"},{"type":"output","id":"gLLAuEZLVrh-tKUEvm972","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5eb9e871b09c889f89ba5d70e5b88b69","path":"/ams2025/_preview/2/build/5eb9e871b09c889f89ba5d70e5b88b69.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c32eb5e5f25bb8cb94e0ec84284f747","path":"/ams2025/_preview/2/build/7c32eb5e5f25bb8cb94e0ec84284f747.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f21f5dbbd9e0c9603e3df638d169ca2","path":"/ams2025/_preview/2/build/3f21f5dbbd9e0c9603e3df638d169ca2.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"cc2PQ7Pw58"}],"key":"eNH6tvEQ7D"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API provides colormaps and colorbars tailored to GPM product variables with the goal of simplifying the data analysis and make it more reproducible.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KtZjzBx14h"}],"key":"AcAl6EjWlG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The default colormap and colorbar configurations are defined into YAML files into the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZWziVrHlPF"},{"type":"link","url":"https://github.com/ghiggi/gpm_api/blob/main/gpm/etc/colorbars/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"gpm/etc/colorbars directory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LdgfksudLI"}],"urlSource":"https://github.com/ghiggi/gpm_api/blob/main/gpm/etc/colorbars/","data":{"kind":"file","org":"ghiggi","repo":"gpm_api","reference":"main","file":"gpm/etc/colorbars/","raw":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/gpm/etc/colorbars/"},"internal":false,"protocol":"github","key":"kNk8JzeUNP"},{"type":"text","value":" of the software.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sfk5yuxhr7"}],"key":"arqWTi9Sfz"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, users are free to override, add and/or customize the colorbars configurations using the pycolorbar (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DmM8VaroaQ"},{"type":"link","url":"https://pycolorbar.readthedocs.io/en/latest/index.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​pycolorbar​.readthedocs​.io​/en​/latest​/index​.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QLoN779zCl"}],"urlSource":"https://pycolorbar.readthedocs.io/en/latest/index.html","key":"MrhGtyvhdQ"},{"type":"text","value":") registry.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xRZk3cLLxD"}],"key":"A0U1N6bKpR"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The registered colorbar configurations can be displayed using ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yQgHJVXoZj"},{"type":"inlineCode","value":"gpm.colorbars.show_colorbars()","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tMfkKJjwu5"},{"type":"text","value":" and the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PN3HX1sOhv"},{"type":"inlineCode","value":"plot_kwargs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hwte7nAWKx"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NokOeUZ0LD"},{"type":"inlineCode","value":"cbar_kwargs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cjVRxmP2pc"},{"type":"text","value":" required to customize the figure can be obtained by calling the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ctBquXWStk"},{"type":"inlineCode","value":"gpm.get_plot_kwargs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mNJLnsAEng"},{"type":"text","value":" function. Here below we provide an example on how to display DPR precipitation rates estimates using the same colorbar used by NASA to display IMERG liquid precipitation estimates.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BJ65m0y5aH"}],"key":"XgEUJud8rj"}],"key":"rh1YPyf9XP"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_kwargs, cbar_kwargs = gpm.get_plot_kwargs(\"IMERG_Liquid\")\nds_subset[\"precipRateNearSurface\"].gpm.plot_map(cbar_kwargs=cbar_kwargs, **plot_kwargs)","key":"W7aR5E0uij"},{"type":"output","id":"akQgQQR5HHITCMuRk2E3G","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb5681f4d0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cb79ebc8c562c4eb96fdc184cc486c44","path":"/ams2025/_preview/2/build/cb79ebc8c562c4eb96fdc184cc486c44.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"ZIupLES7JE"}],"key":"MO2rjAhRIK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since GPM Datasets are characterized by multiple dimensions, GPM-API provides the capabilities to generate FacetGrid Cartopy plots following the classical xarray syntax:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BlD2EkKg2r"}],"key":"mnw2Tok4yF"}],"key":"rMhH5C6nrH"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset = ds.gpm.sel(gpm_id=slice(start_gpm_id, end_gpm_id))\n\n# Plot reflectivity at various levels\nvariable = \"zFactorFinal\"\nda = ds_subset[variable].sel(range=[100, 125, 150, 170])\nfc = da.gpm.plot_map(row=\"radar_frequency\", col=\"range\")\n\n# Surface reflectivity at Ku and Ka band\nvariable = \"zFactorFinalNearSurface\"\nda = ds_subset[variable]\nfc = da.gpm.plot_map(col=\"radar_frequency\", col_wrap=2)","key":"fNZqVYfex7"},{"type":"output","id":"O6GXvhi5KnvvlycJ9Of_F","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"28aef10794f00ab9f005346233c98507","path":"/ams2025/_preview/2/build/28aef10794f00ab9f005346233c98507.png"},"text/plain":{"content":"<Figure size 1300x700.372 with 16 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1acb786a303cb587cb4163f5313be280","path":"/ams2025/_preview/2/build/1acb786a303cb587cb4163f5313be280.png"},"text/plain":{"content":"<Figure size 700x358.423 with 4 Axes>","content_type":"text/plain"}}}],"key":"pFy8w1ORhT"}],"key":"JZxtNCVBbn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5. Plot Cross-Sections","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lE2H2jZEIz"}],"identifier":"id-5-plot-cross-sections","label":"5. Plot Cross-Sections","html_id":"id-5-plot-cross-sections","implicit":true,"key":"zrE6MdOph8"}],"key":"tlHz4fLVy3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"An easy way to derive a vertical cross-section is to slice the data along the cross-track or along-track dimension.\nWe can then plot the cross-section calling the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iIBcvdEA7b"},{"type":"inlineCode","value":"gpm.plot_cross_section()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JK6M1HZOQE"},{"type":"text","value":" method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P2M8fjZKQZ"}],"key":"Uz6cxSrM4i"}],"key":"c2wAwDPrzk"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset = ds.gpm.sel(\n    gpm_id=slice(start_gpm_id, end_gpm_id), radar_frequency=\"Ku\"\n).compute()\nds_subset[\"zFactorFinal\"].isel(cross_track=24).gpm.plot_cross_section(zoom=True)\nds_subset[\"zFactorFinal\"].isel(along_track=30).gpm.plot_cross_section(\n    y=\"height_km\", x=\"horizontal_distance_km\", zoom=True\n)","key":"Xg6uJY27h7"},{"type":"output","id":"l2Dj31ilBTdaWsHTGlZKI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f8b45e5cb6a77f1436da8bef8ca5ff16","path":"/ams2025/_preview/2/build/f8b45e5cb6a77f1436da8bef8ca5ff16.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6b92366a5f274c3353ef7413f21271c0","path":"/ams2025/_preview/2/build/6b92366a5f274c3353ef7413f21271c0.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"JY5XrEDGac"}],"key":"lwJ9cK6E23"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The cross-section transect can be visualized calling the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aob36JBJn8"},{"type":"inlineCode","value":"gpm.plot_transect_line","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VoxL30d6NT"},{"type":"text","value":" method:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mT1IJsDzxo"}],"key":"b7DPGBfVVC"}],"key":"NtfSdx11q3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_transect = ds_subset.isel(cross_track=24)\ntext_kwargs = {\n    \"bbox\": dict(\n        facecolor=\"white\", alpha=0.6, edgecolor=\"black\", boxstyle=\"round,pad=0.2\"\n    )\n}\np = ds_subset[\"zFactorFinalNearSurface\"].gpm.plot_map()\nds_transect.gpm.plot_transect_line(ax=p.axes, text_kwargs=text_kwargs)","key":"Qnxdn54MpQ"},{"type":"output","id":"0ObxmfvwV7pxRPUnOcyx1","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ba7a4c31e114b500678f20158c10265","path":"/ams2025/_preview/2/build/0ba7a4c31e114b500678f20158c10265.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"EUTgjmJOsk"}],"key":"Yq42FMe5N1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The cross-section variables available in a transect dataset can be listed or selected with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Su5siwdKad"},{"type":"inlineCode","value":"gpm.cross_section_variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DBKS4Sa1OY"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RBeFzIVOXr"},{"type":"inlineCode","value":"gpm.select_cross_section_variables()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u4CuArmXG6"},{"type":"text","value":" respectively:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ouCmxKTh1E"}],"key":"x97A27Jwgw"}],"key":"SEHnNyyEMQ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_transect = ds_subset.isel(cross_track=24)\nprint(ds_transect.gpm.cross_section_variables)\nds_transect.gpm.select_cross_section_variables()","key":"UwzWB4BdRy"},{"type":"output","id":"UpYt9DewxgWCpszpZ9USy","data":[{"name":"stdout","output_type":"stream","text":"['DFRforward1', 'Dm', 'Nw', 'airTemperature', 'attenuationNP', 'dBNw', 'epsilon', 'flagEcho', 'flagSLV', 'phase', 'precipRate', 'precipWater', 'range_distance_from_satellite', 'zFactorFinal', 'zFactorMeasured']\n"},{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"590ad069b2db278590c549e2830e406a","path":"/ams2025/_preview/2/build/590ad069b2db278590c549e2830e406a.html"},"text/plain":{"content":"<xarray.Dataset> Size: 2MB\nDimensions:                        (along_track: 151, range: 176)\nCoordinates: (12/15)\n    SCorientation                  (along_track) float32 604B 0.0 0.0 ... 0.0\n    crsWGS84                       int64 8B 0\n    dataQuality                    (along_track) float32 604B 0.0 0.0 ... 0.0\n    gpm_along_track_id             (along_track) int64 1kB 2768 2769 ... 2918\n    gpm_cross_track_id             int64 8B 24\n    gpm_granule_id                 (along_track) int64 1kB 53847 53847 ... 53847\n    ...                             ...\n    lat                            (along_track) float32 604B 32.04 ... 37.89\n    lon                            (along_track) float32 604B -119.2 ... -115.4\n    radar_frequency                <U2 8B 'Ku'\n  * range                          (range) int64 1kB 1 2 3 4 ... 173 174 175 176\n    sunLocalTime                   (along_track) float32 604B 14.2 ... 14.48\n    time                           (along_track) datetime64[ns] 1kB 2023-08-2...\nDimensions without coordinates: along_track\nData variables: (12/15)\n    DFRforward1                    (along_track, range) float32 106kB nan ......\n    Dm                             (along_track, range) float32 106kB nan ......\n    Nw                             (along_track, range) float32 106kB nan ......\n    airTemperature                 (along_track, range) float32 106kB 214.1 ....\n    attenuationNP                  (along_track, range) float32 106kB 0.0 ......\n    dBNw                           (along_track, range) float32 106kB nan ......\n    ...                             ...\n    phase                          (along_track, range) float32 106kB nan ......\n    precipRate                     (along_track, range) float32 106kB 0.0 ......\n    precipWater                    (along_track, range) float32 106kB 0.0 ......\n    range_distance_from_satellite  (along_track, range) float64 213kB nan ......\n    zFactorFinal                   (along_track, range) float32 106kB nan ......\n    zFactorMeasured                (along_track, range) float32 106kB nan ......\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"Sx9pBMwyJ5"}],"key":"qDJE1Wu63M"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API provides accessor methods to facilitate the extraction of cross-section:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HIwQaugWIl"}],"key":"IoI1CtSb2X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"around a point","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RpcxbUIkh3"}],"key":"Lt1n2xQKnU"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"between points","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gs96gGxtrR"}],"key":"GSZJhIzeqn"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"and along a trajectory.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XADrEaVCCw"}],"key":"DExDuTqn2a"}],"key":"yWAiJDm0oG"}],"key":"oz5aUAqbvp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"da_cross = ds_subset[\"zFactorFinal\"].gpm.extract_transect_between_points(\n    start_point=(-118, 32), end_point=(-118, 36), steps=60\n)\nda_cross.gpm.plot_cross_section(zoom=True)","key":"kVon37njvU"},{"type":"output","id":"XaDHotY5ReL0MawiIrN2I","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8da9f4529f1b5f321f018780b6388381","path":"/ams2025/_preview/2/build/8da9f4529f1b5f321f018780b6388381.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"vqbYk1h7W1"}],"key":"xdz4qPGuJd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"points = np.ones((100, 2))\npoints[:, 0] = -118\npoints[:, 1] = np.linspace(32, 36, 100)\nda_cross = ds_subset[\"zFactorFinal\"].gpm.extract_transect_at_points(points=points)\nda_cross.gpm.plot_cross_section(zoom=True)","key":"dB0TL1tf0I"},{"type":"output","id":"pzy3e7A3QdCCi5fLi09fI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f8620f994f7dc79072f56ee171701843","path":"/ams2025/_preview/2/build/f8620f994f7dc79072f56ee171701843.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"i7DZF19vYu"}],"key":"JYsPz0fnbZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"da_cross = ds_subset[\"zFactorFinal\"].gpm.extract_transect_around_point(\n    point=(-118, 34), azimuth=0, distance=100_000, steps=100\n)  # azimuth [0, 360]\nda_cross.gpm.plot_cross_section(zoom=True)","key":"PkHDKYgL8w"},{"type":"output","id":"dEaoJXnq0XcQfZjgUTN6l","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fee536ac9dce0b521336580f2108962e","path":"/ams2025/_preview/2/build/fee536ac9dce0b521336580f2108962e.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"DJ2yW48Fij"}],"key":"m9v2oRkLuN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6. Community-based retrievals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rJ6tmsqluc"}],"identifier":"id-6-community-based-retrievals","label":"6. Community-based retrievals","html_id":"id-6-community-based-retrievals","implicit":true,"key":"k6Rzzv0zaF"}],"key":"HOqws03Ik7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API aims to be a platform where scientist can share their algorithms and retrievals with the community.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1W3ELmYvi"}],"key":"eCZVrc7Wye"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Based on the GPM product you are working with, you will have a series of retrievals available to you.\nFor example, GPM-API currently provide the following retrievals for the 2A-DPR product:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OcFxUnjVYT"}],"key":"CKL6XhG9YI"}],"key":"cDfTzHFDdH"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds.gpm.available_retrievals()","key":"aWrjy0xCZG"},{"type":"output","id":"hP0eJk4XkLMGuuHZycbVg","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"['EchoDepth',\n 'EchoTopHeight',\n 'HailKineticEnergy',\n 'MESH',\n 'MESHS',\n 'POH',\n 'POSH',\n 'REFC',\n 'REFCH',\n 'SHI',\n 'VIL',\n 'VILD',\n 'bright_band_ratio',\n 'c_band_tan',\n 'dfrFinal',\n 'dfrFinalNearSurface',\n 'dfrMeasured',\n 'flagHydroClass',\n 'flagPrecipitationType',\n 'gate_resolution',\n 'gate_volume',\n 'heightClutterFreeBottom',\n 'heightRealSurfaceKa',\n 'heightRealSurfaceKu',\n 'range_distance_from_ellipsoid',\n 'range_distance_from_satellite',\n 'range_resolution',\n 's_band_cao2013',\n 'x_band_tan']","content_type":"text/plain"}}}],"key":"jIAkVIMX6E"}],"key":"wCUxN9beFV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RJ6ugfPcTt"},{"type":"inlineCode","value":"gpm.retrieve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q60RagwWuD"},{"type":"text","value":" method enables you to apply specific retrievals to your dataset.\nHere below we provide a couple of examples:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cvgsPJmVFe"}],"key":"jFdMVtUGdg"}],"key":"eloaGxPSq2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset = ds.gpm.sel(\n    gpm_id=slice(start_gpm_id, end_gpm_id), radar_frequency=\"Ku\"\n).compute()\n\nds_subset[\"EchoTopHeight40dBZ\"] = ds_subset.gpm.retrieve(\"EchoTopHeight\", threshold=40)\nds_subset[\"EchoTopHeight40dBZ\"].gpm.plot_map()","key":"qUNDuH4mgx"},{"type":"output","id":"x0ENvVyP22q050GtREwAO","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb562a5610>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c263eaf634a465c47f39ba8acadcf04f","path":"/ams2025/_preview/2/build/c263eaf634a465c47f39ba8acadcf04f.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"RN0g7iwB2F"}],"key":"rFYJkUPW0Y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset[\"EchoDepthSolid30dBZ\"] = ds_subset.gpm.retrieve(\n    \"EchoDepth\", threshold=30, mask_liquid_phase=True\n)\nds_subset[\"EchoDepthSolid30dBZ\"].gpm.plot_map()","key":"PStdJCPulg"},{"type":"output","id":"X1U5wDEmEAthi4jXyrFLI","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb8416f4d0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a7e709f1aa57c8a402f5f4ca62394453","path":"/ams2025/_preview/2/build/a7e709f1aa57c8a402f5f4ca62394453.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"wp0g8dfwpt"}],"key":"aIE98G8u2C"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset[\"VIL\"] = ds_subset.gpm.retrieve(\"VIL\")\nds_subset[\"VIL\"].gpm.plot_map()","key":"l6FSptUYtt"},{"type":"output","id":"ak6WlSGIdUWPd_XmyGhSd","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb659d68d0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6856cee33a8899867ec64d9c572f0b8f","path":"/ams2025/_preview/2/build/6856cee33a8899867ec64d9c572f0b8f.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"d2YaTA5Mal"}],"key":"heEv6IRPl6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset[\"flagPrecipitationType\"] = ds_subset.gpm.retrieve(\n    \"flagPrecipitationType\", method=\"major_rain_type\"\n)\nds_subset[\"flagPrecipitationType\"].gpm.plot_map()","key":"b1iROMX8Be"},{"type":"output","id":"2UI1P-amDAGyL9eZ_XUcY","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb65adcb90>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"181b4253f2a69daec3a42f4b5376b7d4","path":"/ams2025/_preview/2/build/181b4253f2a69daec3a42f4b5376b7d4.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"QXocQHoczl"}],"key":"I0foeuhfmC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_subset[\"flagHydroClass\"] = ds_subset.gpm.retrieve(\n    \"flagHydroClass\"\n)  # this return a 3D array !\nds_subset[\"flagHydroClass\"].isel(cross_track=24).gpm.plot_cross_section()","key":"NXKW1UDF6B"},{"type":"output","id":"HRNGpu06Szmfq7vYo0kzb","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4f4f24e505dffca220265b68767d582d","path":"/ams2025/_preview/2/build/4f4f24e505dffca220265b68767d582d.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"vMd741P5hS"}],"key":"K7jiRy1WP4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7. Advanced Manipulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SYDIEM7ZZC"}],"identifier":"id-7-advanced-manipulations","label":"7. Advanced Manipulations","html_id":"id-7-advanced-manipulations","implicit":true,"key":"oC5pTjIao7"}],"key":"k9KNEyVQw9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When working with spaceborne radar data, it is often necessary to slice, extract or mask portions of data across the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QZZI5MOCug"},{"type":"inlineCode","value":"range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tU4h5liixo"},{"type":"text","value":" dimension.\nThe xarray ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tb2jr9240q"},{"type":"inlineCode","value":"gpm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"un223Z7ri8"},{"type":"text","value":" accessor provides a series of methods to facilitate various tasks.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aKh27VWDSy"}],"key":"fFxmp15VQt"}],"key":"c1mu5AsTSf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"If you wish to extract the values at specific range gate position varying over each radar beam, you can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n4QZSI81hK"},{"type":"inlineCode","value":"slice_range_at_bin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oYurcQdAvE"},{"type":"text","value":" method.\nFor example, to extract values near the surface where radar gates are not more contaminated by ground clutter, you can use the bin variable ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zfwinMOPp8"},{"type":"inlineCode","value":"\"binClutterFreeBottom\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Asl5q5LBJQ"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t5djgRVwJa"}],"key":"VBDlj7eBSL"}],"key":"xuH4ybANQE"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_surface = ds_subset.gpm.slice_range_at_bin(\n    bins=\"binClutterFreeBottom\"\n)  # or ds.gpm.slice_range_at_bin(bins=ds[\"binClutterFreeBottom\"])\nds_surface[\"precipRate\"].gpm.plot_map()  # precipRate is originally a 3D variable !\nds_surface[\"zFactorFinal\"].gpm.plot_map()  # zFactorFinal is originally a 3D variable !","key":"Mbn2ktWomT"},{"type":"output","id":"9DEpSW4scQNtX-_JeLsFL","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb56248a90>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"65a762b511f35658b1bcf3b7dedaf4f6","path":"/ams2025/_preview/2/build/65a762b511f35658b1bcf3b7dedaf4f6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36c3af6b94d7127dd221ac03d9d303b0","path":"/ams2025/_preview/2/build/36c3af6b94d7127dd221ac03d9d303b0.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"ZH8GVsVdfJ"}],"key":"bsojfNsU4z"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Other slicing methods provide capabilities to retrieve values at a given height, along isothermals, or at the range gates where the minimum, maximum or closest value of a given variable occur:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQkc6EgPCQ"}],"key":"PA7yKxSck3"}],"key":"jPvSM3nUnf"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_isothermal = ds_subset.gpm.slice_range_at_temperature(\n    273.15\n)  # use by default the airTemperature variable\nds_3000 = ds_subset.gpm.slice_range_at_height(3000)\nds_max_z = ds_subset.gpm.slice_range_at_max_value(variable=\"zFactorFinal\")\nds_min_z = ds_subset.gpm.slice_range_at_min_value(variable=\"zFactorFinal\")\nds_at_z_30 = ds_subset.gpm.slice_range_at_value(variable=\"zFactorFinal\", value=30)","key":"u7yeNoq3O7"},{"type":"output","id":"hSmvjvlhZiiMle47E6Dnk","data":[],"key":"UwqsjBvi1s"}],"key":"VwkL86YT5s"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you want to focus your analysis in the portion of radar gates with valid values (e.g., excluding upper atmosphere regions without reflectivities) or values ranging in a specific interval of interest, you can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ErsFdbUb0Q"},{"type":"inlineCode","value":"subset_range_with_valid_data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xf6NGoH3rS"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O1W6BEtE6O"},{"type":"inlineCode","value":"subset_range_where_values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OVcPV656LO"},{"type":"text","value":" methods respectively:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qLuSodavQ2"}],"key":"qN03Ow1iif"}],"key":"SMhAqLgEId"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_valid = ds_subset.gpm.subset_range_with_valid_data(variable=\"zFactorFinal\")\nds_intense = ds_subset.gpm.subset_range_where_values(\n    variable=\"precipRate\", vmin=200, vmax=300\n)  # mm/hr\nprint(\"Range with valid data:\", ds_valid[\"range\"].data)\nprint(\"Range with intense precipitation:\", ds_intense[\"range\"].data)","key":"QII2Reqyhl"},{"type":"output","id":"_ddR5_gHHNoGfzM3rktmD","data":[{"name":"stdout","output_type":"stream","text":"Range with valid data: [ 93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110\n 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128\n 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146\n 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164\n 165 166 167 168 169 170 171 172 173 174 175 176]\nRange with intense precipitation: [166 167 168 169 170 171 172 173 174 175 176]\n"}],"key":"wLyqqElNG2"}],"key":"Y7YjZzKUHs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"If you wish to extract radar gates above/below spatially-varying bin position, you can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WtCV8gAGhm"},{"type":"inlineCode","value":"extract_dataset_above_bin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wusMdOIh6y"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FoRoEFSDlv"},{"type":"inlineCode","value":"extract_dataset_below_bin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sRU2ZPq89N"},{"type":"text","value":" methods.\nPlease note that these methods shifts the arrays beam-wise, returning datasets with a new ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a5wBFBopmW"},{"type":"inlineCode","value":"range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LG8kf01Csp"},{"type":"text","value":" coordinate and the bin variables updated accordingly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aKoFuPx4KT"}],"key":"TTT4jcsyb7"}],"key":"yosPAgpWuG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_below_melting_layer = ds_subset.gpm.extract_dataset_below_bin(\n    \"binBBBottom\"\n)  # the first new range index corresponds to original binBBBottom\nds_above_melting_layer = ds_subset.gpm.extract_dataset_above_bin(\n    \"binBBTop\"\n)  # the last new range index corresponds to original binBBTop","key":"dyOwXLbQOC"},{"type":"output","id":"xt95UMjS0FZFs3P22KgkB","data":[],"key":"ow53wFfCsi"}],"key":"WdbvaJmDkw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If instead you wish to mask the data above/below or in between radar gates positions, you can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hayblbpogs"},{"type":"inlineCode","value":"mask_above_bin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h5YJCmIOAY"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pdv0nqPvpn"},{"type":"inlineCode","value":"mask_below_bin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ewf5KNU79K"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BDdD24n8rp"},{"type":"inlineCode","value":"mask_between_bins","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EkIVkGi7hn"},{"type":"text","value":" methods:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kvwj8Wdrgi"}],"key":"GF782qNxZt"}],"key":"XuUgkXe3LI"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_rain = ds_subset.gpm.mask_above_bin(\"binZeroDeg\")\nds_snow = ds_subset.gpm.mask_below_bin(\"binZeroDeg\")\nds_masked_melting_layer = ds_subset.gpm.mask_between_bins(\n    bottom_bins=\"binBBBottom\", top_bins=\"binBBTop\"\n)","key":"xJsTuGOweO"},{"type":"output","id":"RGvZje8SoYEX8KAWBsj_h","data":[],"key":"mnNbRbrA1j"}],"key":"KRHgxxtsbS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"8. Geospatial Manipulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdM2Zcj0zM"}],"identifier":"id-8-geospatial-manipulations","label":"8. Geospatial Manipulations","html_id":"id-8-geospatial-manipulations","implicit":true,"key":"A4S4IcfxHp"}],"key":"XsLqvz5Mvy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API provides methods to easily spatially subset orbits by extent, country or continent.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RyNSeq5TJE"}],"key":"Ai6CiHl6HJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Note however, that an area can be crossed by multiple orbits depending on the size of your GPM satellite dataset.\nIn other words, multiple orbit slices in along-track direction can intersect the area of interest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E9Z7OdoW8K"}],"key":"SPi26943Y8"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The method ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eVkMQvbm5q"},{"type":"inlineCode","value":"get_crop_slices_by_extent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nwBLokmZJE"},{"type":"text","value":", ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"U2t14CwIXZ"},{"type":"inlineCode","value":"get_crop_slices_by_country","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gBxlpmpcrG"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oV5xmgJgpn"},{"type":"inlineCode","value":" get_crop_slices_by_continent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hrGLxlDUr5"},{"type":"text","value":" enable to retrieve the orbit portions intersecting the area of interest.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CkzYZojLYN"}],"key":"byliu7HSB0"}],"key":"YdLRS2Oevd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the variable to display\nvariable = \"precipRateNearSurface\"\n\n# Crop by country\nlist_isel_dict = ds.gpm.get_crop_slices_by_country(\"United States\")\nprint(list_isel_dict)\n\n# Crop by extent\nextent = get_country_extent(\"United States\")\nlist_isel_dict = ds.gpm.get_crop_slices_by_extent(extent)\nprint(list_isel_dict)\n\n# Plot the swaths crossing the country\nfor isel_dict in list_isel_dict:\n    da_subset = ds[variable].isel(isel_dict)\n    slice_title = da_subset.gpm.title(add_timestep=True)\n    p = da_subset.gpm.plot_map()\n    p.axes.set_extent(extent)\n    p.axes.set_title(label=slice_title)\n\n# Define the variable to display\nvariable = \"precipRateNearSurface\"\n\n# Crop around a point (i.e. radar location)\nlon = -117.0418\nlat = 32.9190\ndistance = 200_000  # 200 km\nlist_isel_dict = ds.gpm.get_crop_slices_around_point(\n    lon=lon, lat=lat, distance=distance\n)\nprint(list_isel_dict)\n\nextent = get_geographic_extent_around_point(lon=lon, lat=lat, distance=distance)\nlist_isel_dict = ds.gpm.get_crop_slices_by_extent(extent)\nprint(list_isel_dict)\n\n# Define ROI coordinates\ncircle_lons, circle_lats = get_circle_coordinates_around_point(\n    lon, lat, radius=distance, num_vertices=360\n)\n\n# Plot the swaths crossing the ROI\nfor isel_dict in list_isel_dict:\n    da_subset = ds[variable].isel(isel_dict)\n    slice_title = da_subset.gpm.title(add_timestep=True)\n    p = da_subset.gpm.plot_map()\n    p.axes.plot(circle_lons, circle_lats, \"r-\", transform=ccrs.Geodetic())\n    p.axes.scatter(lon, lat, c=\"black\", marker=\"X\", s=100, transform=ccrs.Geodetic())\n    p.axes.set_extent(extent)\n\n# Alternatives if working with a single granule:\n\n# ds_subset = ds.gpm.crop_by_extent(extent)\n# ds_subset = ds.gpm.crop_by_country(\"United States\")","key":"ZVXEXkB4UN"},{"type":"output","id":"bF8coBt3_nDpmISiFmoxQ","data":[{"name":"stdout","output_type":"stream","text":"[{'along_track': slice(2426, 3805, None)}]\n[{'along_track': slice(2426, 3805, None)}]\n[{'along_track': slice(2751, 2852, None)}]\n[{'along_track': slice(2751, 2852, None)}]\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"07ad0c34084a375bc5b5675495b192b4","path":"/ams2025/_preview/2/build/07ad0c34084a375bc5b5675495b192b4.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0eea7208ce1501195de9c545fcf85f56","path":"/ams2025/_preview/2/build/0eea7208ce1501195de9c545fcf85f56.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"pLakQmAapM"}],"key":"oEKwvM2Bga"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can also easily obtain the extent around a given point (i.e. ground radar location) using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IuqZZG5xj5"},{"type":"inlineCode","value":"get_geographic_extent_around_point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r5cw6Tlkgt"},{"type":"text","value":" function and use\nthe gpm accessor methods ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QiNu4Np4QR"},{"type":"inlineCode","value":"get_crop_slices_around_point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oQQ7HMX8Rm"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lcwi6Y7E5d"},{"type":"inlineCode","value":"crop_around_point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VM1Uk4urD8"},{"type":"text","value":" to subset your dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C8EYucESqG"}],"key":"n5gpSJ4zkn"}],"key":"ih1cghzIT4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the variable to display\nvariable = \"precipRateNearSurface\"\n\n# Crop around a point (i.e. radar location)\nlon = -117.0418\nlat = 32.9190\ndistance = 200_000  # 200 km\nlist_isel_dict = ds.gpm.get_crop_slices_around_point(\n    lon=lon, lat=lat, distance=distance\n)\nprint(list_isel_dict)\n\nextent = get_geographic_extent_around_point(lon=lon, lat=lat, distance=distance)\nlist_isel_dict = ds.gpm.get_crop_slices_by_extent(extent)\nprint(list_isel_dict)\n\n# Define ROI coordinates\ncircle_lons, circle_lats = get_circle_coordinates_around_point(\n    lon, lat, radius=distance, num_vertices=360\n)\n\n# Plot the swaths crossing the ROI\nfor isel_dict in list_isel_dict:\n    da_subset = ds[variable].isel(isel_dict)\n    slice_title = da_subset.gpm.title(add_timestep=True)\n    p = da_subset.gpm.plot_map()\n    p.axes.plot(circle_lons, circle_lats, \"r-\", transform=ccrs.Geodetic())\n    p.axes.scatter(lon, lat, c=\"black\", marker=\"X\", s=100, transform=ccrs.Geodetic())\n    p.axes.set_extent(extent)\n\n# Alternatives if working with a single granule:\n\n# ds_subset = ds.gpm.crop_around_point(lon=lon, lat=lat, distance=distance)","key":"RjrGJkpimC"},{"type":"output","id":"aKmMxLdEMpySOjS-QM2EC","data":[{"name":"stdout","output_type":"stream","text":"[{'along_track': slice(2751, 2852, None)}]\n[{'along_track': slice(2751, 2852, None)}]\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0eea7208ce1501195de9c545fcf85f56","path":"/ams2025/_preview/2/build/0eea7208ce1501195de9c545fcf85f56.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"eMlDbswgfs"}],"key":"VeZ7RNB545"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Please keep in mind that you can easily retrieve the extent of a GPM xarray object using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eKjjIVyRkJ"},{"type":"inlineCode","value":"extent","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S2rbuNZebH"},{"type":"text","value":" method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XHCZkPFMBr"}],"key":"lEFB4LXqwv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The optional argument ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kBRxXpOsyu"},{"type":"inlineCode","value":"padding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jx9ZVv0JVr"},{"type":"text","value":" allows to expand/shrink the geographic extent by custom lon/lat degrees, while the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fWVhbKpjkJ"},{"type":"inlineCode","value":"size","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"stWt9okxLX"},{"type":"text","value":" argument allows\nto obtain an extent centered on the GPM object with the desired size.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hCSuWMeFwX"}],"key":"w3pbtDDMdj"}],"key":"cWC0Ff7ER0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(da_subset.gpm.extent(padding=0.1))  # expanding\nprint(da_subset.gpm.extent(padding=-0.1))  # shrinking\nprint(da_subset.gpm.extent(size=0.5))\nprint(da_subset.gpm.extent(size=0))  # centroid","key":"O06elsjD6x"},{"type":"output","id":"Tu2ZgeRSqpAAv_J4JBfjD","data":[{"name":"stdout","output_type":"stream","text":"Extent(xmin=-120.85270843505859, xmax=-115.86820831298829, ymin=30.720465087890624, ymax=35.94685516357422)\nExtent(xmin=-120.6527084350586, xmax=-116.06820831298828, ymin=30.920465087890626, ymax=35.74685516357422)\nExtent(xmin=-118.61045837402344, xmax=-118.11045837402344, ymin=33.08366012573242, ymax=33.58366012573242)\nExtent(xmin=-118.36045837402344, xmax=-118.36045837402344, ymin=33.33366012573242, ymax=33.33366012573242)\n"}],"key":"rQ8DQVKXqw"}],"key":"Lqb7n3184c"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"9. Storm Labeling","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ksst9m5Tmm"}],"identifier":"id-9-storm-labeling","label":"9. Storm Labeling","html_id":"id-9-storm-labeling","implicit":true,"key":"Mm79kP4uTL"}],"key":"mAOLrBT9p8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using the xarray ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NMZntIemu9"},{"type":"inlineCode","value":"ximage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v6unyl39ED"},{"type":"text","value":" accessor, it is possible to easily delineate (label) the precipitating areas. The label array is added to the dataset as a new coordinate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kb7U5Gctvn"}],"key":"KauaLvUzTN"}],"key":"fc2XO67lMd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve labeled xarray object\nlabel_name = \"label\"\nds = ds.ximage.label(\n    variable=\"precipRateNearSurface\",\n    min_value_threshold=1,\n    min_area_threshold=5,\n    footprint=5,  # assign same label to precipitating areas 5 pixels apart\n    sort_by=\"area\",  # \"maximum\", \"minimum\", <custom_function>\n    sort_decreasing=True,\n    label_name=label_name,\n)\n# Plot full label array\nds[label_name].ximage.plot_labels()","key":"bZJr1T7zUh"},{"type":"output","id":"rbiZT3g5KB0js4PnL3Oey","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"321cb5568e7724addb2c3da51a156e26","path":"/ams2025/_preview/2/build/321cb5568e7724addb2c3da51a156e26.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"cvsz1Tq0tL"}],"key":"mI9fUu0vMa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s zoom in a specific region:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gCoX9aNV9G"}],"key":"pzvsccnbIl"}],"key":"omwox9MzJW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gpm.plot_labels(ds[label_name].isel(along_track=slice(2700, 3500)))","key":"DsWIiAbm4P"},{"type":"output","id":"gadUTtzK6BC3Xh-B2chZT","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"166ea0b8be1578ae1f629e30d22e9f2b","path":"/ams2025/_preview/2/build/166ea0b8be1578ae1f629e30d22e9f2b.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"jq4lqYLed3"}],"key":"s8YB3PHFe9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10. Patch Extraction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RelfFel6if"}],"identifier":"id-10-patch-extraction","label":"10. Patch Extraction","html_id":"id-10-patch-extraction","implicit":true,"key":"njgewP5XTd"}],"key":"aYTs1CPLgG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the xarray ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0mKJvrUr6"},{"type":"inlineCode","value":"ximage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ajN8hxVGW1"},{"type":"text","value":" accessor, it is also possible to extract patches around the precipitating areas. Here we provide a minimal example on how to proceed:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NVhnbxkIX7"}],"key":"JlVCsCQR7L"}],"key":"YwEl8G1R6N"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the patch generator\nda_patch_gen = ds[\"precipRateNearSurface\"].ximage.label_patches(\n    label_name=label_name,\n    patch_size=(49, 49),\n    # Output options\n    n_patches=4,\n    # Patch extraction Options\n    padding=0,\n    centered_on=\"max\",\n    # Tiling/Sliding Options\n    debug=False,\n    verbose=False,\n)\n\n# # Retrieve list of patches\nlist_label_patches = list(da_patch_gen)\nlist_da = [da for label, da in list_label_patches]\n\n# Display patches\ngpm.plot_patches(list_label_patches)","key":"MbK8M4sKLB"},{"type":"output","id":"WaR56QKuYr8B40YcQSLz7","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e578c18369dcd117b723e9ad9e33afde","path":"/ams2025/_preview/2/build/e578c18369dcd117b723e9ad9e33afde.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8886e9c91f4849ebf73a1a0c1dc0defc","path":"/ams2025/_preview/2/build/8886e9c91f4849ebf73a1a0c1dc0defc.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7b6649b5b55ae6667032b30c57030e5","path":"/ams2025/_preview/2/build/b7b6649b5b55ae6667032b30c57030e5.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"906d63fe050f6ef22c40c317eccac5fd","path":"/ams2025/_preview/2/build/906d63fe050f6ef22c40c317eccac5fd.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"eSiVSkajpB"}],"key":"NtM9oBFdd4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can exploit the xarray manipulations and FacetGrid capabilities to quickly create the following figure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TkV67sySwi"}],"key":"tkOMRsIB6H"}],"key":"AZizkErVHg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"list_da_without_coords = [da.drop_vars([\"lon\", \"lat\"]) for da in list_da]\nda_patch = xr.concat(list_da_without_coords, dim=\"patch\")\nda_patch.isel(patch=slice(0, 4)).gpm.plot_image(col=\"patch\", col_wrap=2)","key":"J2Uf9jndJa"},{"type":"output","id":"xt5-P19_EHY19XOUzVwDN","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"<gpm.visualization.facetgrid.ImageFacetGrid at 0x7fbb56899d10>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4342ea1e7a4abd90944cced7454d3bc3","path":"/ams2025/_preview/2/build/4342ea1e7a4abd90944cced7454d3bc3.png"},"text/plain":{"content":"<Figure size 700x600 with 8 Axes>","content_type":"text/plain"}}}],"key":"GNq9PB1c1X"}],"key":"aYLlWXknma"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"11. Spaceborne/Ground Radar Matching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ODFdgko81n"}],"identifier":"id-11-spaceborne-ground-radar-matching","label":"11. Spaceborne/Ground Radar Matching","html_id":"id-11-spaceborne-ground-radar-matching","implicit":true,"key":"fNx07JF0bE"}],"key":"lq1jPCQGdZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this final subsection, we now provide also brief overview on how to match spaceborne (SR) and ground (GR) radar measurements.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IubYm1cNBT"}],"key":"m4cX8Tt7gQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A step-by-step guide on the methodology to obtain spatially and temporally coincident radar samples is provided in\nthe ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ItdkvpIu04"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Matching Tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j7GEiupaot"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","key":"CcVakB68Sr"},{"type":"text","value":",\nwhile an applied example is provided in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GfV3zltoZF"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Calibration Applied Tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GmFWXyKjZs"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","key":"RqNxHpsXkG"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dJMnj9wwUZ"}],"key":"PWL8fcVO3G"}],"key":"ArapH7uiqD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To start let’s open the NEXRAD ground radar data coincident with the GPM DPR overpass. We have preprocessed the native NEXRAD radar with xradar and uploaded it into Zarr format on the Pythia Cloud Bucket.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zm6uRvdOfu"}],"key":"SBzYtmmMux"}],"key":"ZDinPXtcRx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"bucket_url = \"https://js2.jetstream-cloud.org:8001\"\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=bucket_url))\nfile = fs.get_mapper(f\"pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr\")\ndt_gr = open_datatree(file, engine=\"zarr\", consolidated=True, chunks={})\ndisplay(dt_gr)","key":"qeaclzoJ4C"},{"type":"output","id":"JzYbdhwYayc9wW8maaBSh","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9012a7600ab84aad7847829d2ef8f86d","path":"/ams2025/_preview/2/build/9012a7600ab84aad7847829d2ef8f86d.html"},"text/plain":{"content_type":"text/plain","hash":"a4ed0eb4ad3ad105da250c49d6296045","path":"/ams2025/_preview/2/build/a4ed0eb4ad3ad105da250c49d6296045.txt"}}}],"key":"teyo7rTGbS"}],"key":"b4lOE4BVsP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let’s select the GR sweep to match with GPM DPR.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B5IycnFwMN"}],"key":"GCS4SZapga"}],"key":"HqqmsaWkE9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sweep_idx = 0\nsweep_group = f\"sweep_{sweep_idx}\"  # GR sweep (elevation to be used)\nds_gr = dt_gr[sweep_group].to_dataset().compute()","key":"N1vOnjzchD"},{"type":"output","id":"PwYdA-tKVTbk8WXZNH4ua","data":[],"key":"Dj7hUV63jj"}],"key":"yENm231M5M"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s quickly display the PPI for the horizontally and vertically polarized reflectivity. You will notice that the radar is quite miscalibrated !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EXEypoeMpY"}],"key":"dVD0AaZQSJ"}],"key":"Gazy1t4VwO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_gr[\"DBZH\"].where(ds_gr[\"DBZH\"] > -10).xradar_dev.plot_map()\nds_gr[\"DBZV\"] = (ds_gr[\"DBZH\"].gpm.idecibel / ds_gr[\"ZDR\"].gpm.idecibel).gpm.decibel\nds_gr[\"DBZV\"].where(ds_gr[\"DBZV\"] > -10).xradar_dev.plot_map()\n# ds_gr[\"ZDR\"].where(ds_gr[\"DBZV\"] > -10).xradar_dev.plot_map()","key":"F6MHEqF0g5"},{"type":"output","id":"Vf1kTIurBsV-Ije8uwNsK","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7fbb64d7bd90>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a9a7db40d9f9e009017ed7455931b9d","path":"/ams2025/_preview/2/build/2a9a7db40d9f9e009017ed7455931b9d.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b03ba9ec0dccbe161d5e1adfcdf75167","path":"/ams2025/_preview/2/build/b03ba9ec0dccbe161d5e1adfcdf75167.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"exVEC5SuN1"}],"key":"BDNhfczlLX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s define some SR/GR volume matching settings ...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KB8lCgqrOi"}],"key":"eWyPYJfd0g"}],"key":"cv46FU8kJi"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"radar_band = \"S\"\nbeamwidth_gr = 1\nz_min_threshold_gr = 0\nz_min_threshold_sr = 10","key":"Yj1NWDMajs"},{"type":"output","id":"Flo0RTz4QdH3ThTsiLCjt","data":[],"key":"pyNix2bVd6"}],"key":"UI8uxvOPeO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"... and then apply the SR/GR volume matching. If the GPM Dataset is not specified, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sPat657Oef"},{"type":"inlineCode","value":"volume_matching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bMeq7TxBqF"},{"type":"text","value":" automatically download and load the required SR radar data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hIxs4hPH1K"}],"key":"UrEOyh1WfS"}],"key":"YMdIPbRnN6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match = volume_matching(\n    ds_gr=ds_gr,\n    ds_sr=ds,  # optional\n    z_variable_gr=\"DBZH\",\n    radar_band=radar_band,\n    beamwidth_gr=beamwidth_gr,\n    z_min_threshold_gr=z_min_threshold_gr,\n    z_min_threshold_sr=z_min_threshold_sr,\n    min_gr_range=0,\n    max_gr_range=150_000,\n    # gr_sensitivity_thresholds=None,\n    # sr_sensitivity_thresholds=None,\n    download_sr=False,  # require NASA accounts and internet connection !\n    display_quicklook=True,\n)\ndisplay(gdf_match)","key":"VrYE1v6EZk"},{"type":"output","id":"CbTYdlM1f5a-EWinxWYMn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cd9c2dce763339e22f7d7d7605ea09b8","path":"/ams2025/_preview/2/build/cd9c2dce763339e22f7d7d7605ea09b8.png"},"text/plain":{"content":"<Figure size 960x480 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"SR/GR Matching Elapsed time: 0:00:40.832049 .\n"},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>GR_Z_mean</th>\n      <th>GR_Z_std</th>\n      <th>GR_Z_max</th>\n      <th>GR_Z_min</th>\n      <th>GR_Z_range</th>\n      <th>GR_Z_cov</th>\n      <th>GR_time</th>\n      <th>GR_gate_volume_sum</th>\n      <th>GR_fraction_covered_area</th>\n      <th>GR_counts</th>\n      <th>...</th>\n      <th>sweep_number</th>\n      <th>along_track</th>\n      <th>cross_track</th>\n      <th>VolumeRatio</th>\n      <th>VolumeDiff</th>\n      <th>time_difference</th>\n      <th>GR_z_lower_bound</th>\n      <th>GR_z_upper_bound</th>\n      <th>SR_z_lower_bound</th>\n      <th>SR_z_upper_bound</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>15.221830</td>\n      <td>12.594024</td>\n      <td>19.5</td>\n      <td>10.5</td>\n      <td>9.0</td>\n      <td>0.827366</td>\n      <td>2023-08-20 22:13:43.619000064</td>\n      <td>1.325220e+09</td>\n      <td>0.523921</td>\n      <td>50.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>42</td>\n      <td>44.668064</td>\n      <td>5.786978e+10</td>\n      <td>97</td>\n      <td>1535.796701</td>\n      <td>4204.951593</td>\n      <td>1654.094116</td>\n      <td>4209.583984</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>13.581805</td>\n      <td>10.557827</td>\n      <td>18.5</td>\n      <td>10.0</td>\n      <td>8.5</td>\n      <td>0.777351</td>\n      <td>2023-08-20 22:13:43.513999872</td>\n      <td>1.316104e+09</td>\n      <td>0.792108</td>\n      <td>73.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>43</td>\n      <td>47.688195</td>\n      <td>6.144654e+10</td>\n      <td>97</td>\n      <td>1514.601481</td>\n      <td>4200.459785</td>\n      <td>1558.925415</td>\n      <td>4227.430664</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>16.550807</td>\n      <td>15.714381</td>\n      <td>23.0</td>\n      <td>10.0</td>\n      <td>13.0</td>\n      <td>0.949463</td>\n      <td>2023-08-20 22:13:43.414000128</td>\n      <td>1.304555e+09</td>\n      <td>0.966467</td>\n      <td>92.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>44</td>\n      <td>46.511517</td>\n      <td>5.937226e+10</td>\n      <td>97</td>\n      <td>1494.739411</td>\n      <td>4194.752350</td>\n      <td>1605.041138</td>\n      <td>4143.421875</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>19.808129</td>\n      <td>18.675347</td>\n      <td>26.0</td>\n      <td>11.0</td>\n      <td>15.0</td>\n      <td>0.942812</td>\n      <td>2023-08-20 22:13:43.315000064</td>\n      <td>1.292233e+09</td>\n      <td>1.000000</td>\n      <td>98.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>45</td>\n      <td>47.599161</td>\n      <td>6.021699e+10</td>\n      <td>97</td>\n      <td>1475.392380</td>\n      <td>4182.133888</td>\n      <td>1527.083740</td>\n      <td>4056.250488</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>18.983302</td>\n      <td>18.326115</td>\n      <td>24.5</td>\n      <td>10.0</td>\n      <td>14.5</td>\n      <td>0.965381</td>\n      <td>2023-08-20 22:13:43.212000000</td>\n      <td>1.280453e+09</td>\n      <td>1.000000</td>\n      <td>98.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>46</td>\n      <td>48.697237</td>\n      <td>6.107406e+10</td>\n      <td>97</td>\n      <td>1468.574285</td>\n      <td>4156.773245</td>\n      <td>1571.319336</td>\n      <td>4090.862549</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1300</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.476000000</td>\n      <td>NaN</td>\n      <td>0.994502</td>\n      <td>96.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>45</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1537.145386</td>\n      <td>4186.728516</td>\n    </tr>\n    <tr>\n      <th>1301</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.652999936</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>99.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>46</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1580.786865</td>\n      <td>4100.309082</td>\n    </tr>\n    <tr>\n      <th>1302</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.756000000</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>99.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>47</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1527.273315</td>\n      <td>4036.591797</td>\n    </tr>\n    <tr>\n      <th>1303</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.886000128</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>104.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>48</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1469.200317</td>\n      <td>4086.919434</td>\n    </tr>\n    <tr>\n      <th>1304</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.857999872</td>\n      <td>NaN</td>\n      <td>0.606705</td>\n      <td>59.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>158</td>\n      <td>48</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>63</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1598.747192</td>\n      <td>4216.467285</td>\n    </tr>\n  </tbody>\n</table>\n<p>1305 rows × 230 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"      GR_Z_mean   GR_Z_std  GR_Z_max  GR_Z_min  GR_Z_range  GR_Z_cov  \\\n0     15.221830  12.594024      19.5      10.5         9.0  0.827366   \n1     13.581805  10.557827      18.5      10.0         8.5  0.777351   \n2     16.550807  15.714381      23.0      10.0        13.0  0.949463   \n3     19.808129  18.675347      26.0      11.0        15.0  0.942812   \n4     18.983302  18.326115      24.5      10.0        14.5  0.965381   \n...         ...        ...       ...       ...         ...       ...   \n1300        NaN        NaN       NaN       NaN         NaN       NaN   \n1301        NaN        NaN       NaN       NaN         NaN       NaN   \n1302        NaN        NaN       NaN       NaN         NaN       NaN   \n1303        NaN        NaN       NaN       NaN         NaN       NaN   \n1304        NaN        NaN       NaN       NaN         NaN       NaN   \n\n                           GR_time  GR_gate_volume_sum  \\\n0    2023-08-20 22:13:43.619000064        1.325220e+09   \n1    2023-08-20 22:13:43.513999872        1.316104e+09   \n2    2023-08-20 22:13:43.414000128        1.304555e+09   \n3    2023-08-20 22:13:43.315000064        1.292233e+09   \n4    2023-08-20 22:13:43.212000000        1.280453e+09   \n...                            ...                 ...   \n1300 2023-08-20 22:13:51.476000000                 NaN   \n1301 2023-08-20 22:13:51.652999936                 NaN   \n1302 2023-08-20 22:13:51.756000000                 NaN   \n1303 2023-08-20 22:13:51.886000128                 NaN   \n1304 2023-08-20 22:13:51.857999872                 NaN   \n\n      GR_fraction_covered_area  GR_counts  ...  sweep_number along_track  \\\n0                     0.523921       50.0  ...             0          98   \n1                     0.792108       73.0  ...             0          98   \n2                     0.966467       92.0  ...             0          98   \n3                     1.000000       98.0  ...             0          98   \n4                     1.000000       98.0  ...             0          98   \n...                        ...        ...  ...           ...         ...   \n1300                  0.994502       96.0  ...             0         157   \n1301                  1.000000       99.0  ...             0         157   \n1302                  1.000000       99.0  ...             0         157   \n1303                  1.000000      104.0  ...             0         157   \n1304                  0.606705       59.0  ...             0         158   \n\n      cross_track  VolumeRatio    VolumeDiff  time_difference  \\\n0              42    44.668064  5.786978e+10               97   \n1              43    47.688195  6.144654e+10               97   \n2              44    46.511517  5.937226e+10               97   \n3              45    47.599161  6.021699e+10               97   \n4              46    48.697237  6.107406e+10               97   \n...           ...          ...           ...              ...   \n1300           45          NaN           NaN               64   \n1301           46          NaN           NaN               64   \n1302           47          NaN           NaN               64   \n1303           48          NaN           NaN               64   \n1304           48          NaN           NaN               63   \n\n      GR_z_lower_bound  GR_z_upper_bound  SR_z_lower_bound  SR_z_upper_bound  \n0          1535.796701       4204.951593       1654.094116       4209.583984  \n1          1514.601481       4200.459785       1558.925415       4227.430664  \n2          1494.739411       4194.752350       1605.041138       4143.421875  \n3          1475.392380       4182.133888       1527.083740       4056.250488  \n4          1468.574285       4156.773245       1571.319336       4090.862549  \n...                ...               ...               ...               ...  \n1300               NaN               NaN       1537.145386       4186.728516  \n1301               NaN               NaN       1580.786865       4100.309082  \n1302               NaN               NaN       1527.273315       4036.591797  \n1303               NaN               NaN       1469.200317       4086.919434  \n1304               NaN               NaN       1598.747192       4216.467285  \n\n[1305 rows x 230 columns]","content_type":"text/plain"}}}],"key":"dagHe0isQQ"}],"key":"YfPmKbGc6Q"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s display the SR/GR matched/aggregated reflectivities and the preliminary calibration summary:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ebbjIblQKz"}],"key":"nuhZjfOSjM"}],"key":"jKsUIsrAVd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sr_z_column = f\"SR_zFactorFinal_{radar_band}_mean\"\ngr_z_column = \"GR_Z_mean\"","key":"cABjbLMVz3"},{"type":"output","id":"fpYCLp0z5HXhbKPNOpR1E","data":[],"key":"JFtAy5CJTd"}],"key":"yY27u29bzB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compare reflectivities\nfig = compare_maps(\n    gdf_match,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"VHRAw0hWl2"},{"type":"output","id":"hIe2VrtXj3rr9IV58-Bpr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f69a8e015263e8e349e1fd90ebbec133","path":"/ams2025/_preview/2/build/f69a8e015263e8e349e1fd90ebbec133.png"},"text/plain":{"content":"<Figure size 1400x700 with 4 Axes>","content_type":"text/plain"}}}],"key":"tsGa6YoA4p"}],"key":"XF3DxHnxCW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display calibration summary\nfig = calibration_summary(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    # hue_column=\"GR_gate_volume_sum\",\n    hue_column=\"SR_fraction_clutter\",\n    # gr_range=[15, 50]\n    # sr_range=[15, 50]\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"yUXgoMJVjZ"},{"type":"output","id":"igpaSNnWGEUmSw_7n36j2","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c0526864872bc0723ed6409477f9cd1","path":"/ams2025/_preview/2/build/4c0526864872bc0723ed6409477f9cd1.png"},"text/plain":{"content":"<Figure size 1200x500 with 3 Axes>","content_type":"text/plain"}}}],"key":"a1gtBQ5S2h"}],"key":"qfnjUn4zES"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you are interested in this application, please read the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"muTFWL5v1a"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Calibration Applied Tutorial","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bqqOF9BThu"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","key":"yNRIytjaSf"},{"type":"text","value":" to investigate and apply filtering criteria to improve the matching process and the calibration of GR data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WnVgvWMO6b"}],"key":"RJkq7Kss6O"}],"key":"pbGHkjVYjr"}],"key":"FxLhw687Kd"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"wradlib - clutter and beamblockage","url":"/wradlib-clutter-beamblockage","group":"Py-ART and wradlib"},"next":{"title":"I/O model","url":"/baltrad-io","group":"BALTRAD"}}},"domain":"http://localhost:3000"}