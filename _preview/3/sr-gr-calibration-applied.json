{"version":1,"kind":"Notebook","sha256":"6628241ed2c7bebc1e45d850027eeecd898140171fd5c1d2eeec3cab4ca6d3fe","slug":"sr-gr-calibration-applied","location":"/notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb","dependencies":[],"frontmatter":{"title":"Spaceborne-Ground Radar Calibration (Application)","content_includes_title":false,"kernelspec":{"name":"gpm-api-dev","display_name":"gpm-api-dev","language":"python"},"authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/openradar/erad2024","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"SR_GR_Calibration_Applied.ipynb","url":"/ams2025/_preview/3/build/SR_GR_Calibration_Ap-f5c0bb353df23a1a41a4d9427e607d42.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this tutorial, we demonstrate how to exploit GPM-API along with other radar software such\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mjPsHDuTTG"},{"type":"link","url":"https://docs.openradarscience.org/projects/xradar/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"xradar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pqV2pWuDLY"}],"urlSource":"https://docs.openradarscience.org/projects/xradar/en/stable/","key":"cLkc22Fbwi"},{"type":"text","value":" and\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SUiH6ClabJ"},{"type":"link","url":"https://docs.wradlib.org/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wradlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pf3DBG300R"}],"urlSource":"https://docs.wradlib.org/en/latest/","key":"JjOF0Y4Imo"},{"type":"text","value":" to match reflectivities measurements of spaceborne (SR) and ground (GR) radars and assess the GR calibration bias.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zyHDTRTuTw"}],"key":"wAhGC0qZAc"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As example, we analyze a coincident GPM DPR and NEXRAD overpass over San Diego, USA, during the landfall of Tropical Storm Hilary in 2023. The NEXRAD KNKX radar data appears to be significantly miscalibrated and we will assess the calibration bias.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UfAIvcOcTe"}],"key":"VMYswVWFrT"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To facilitate your hands-on experience, we’ve preprocessed the native NEXRAD radar data using the xradar package and the coincident GPM DPR overpass using GPM-API. The resulting data has been uploaded in Zarr format to the Pythia Cloud Bucket, allowing you to start the tutorial directly in the Binder environment.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qzg1muROWH"}],"key":"wOtElCZPe7"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If you wish to adapt this tutorial to your own case study, you can use the xradar package to read your GR radar data into the expected xarray format. Similarly, you can retrieve the relevant GPM data using GPM-API.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vrYbY1nZNi"}],"key":"TDi8JTTxIW"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Additionally, note that the GPM-API’s ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rwUssGo6QK"},{"type":"inlineCode","value":"volume_matching","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"al495um3o6"},{"type":"text","value":" routine can automatically download and open the coincident GPM overpass data if the SR dataset is not provided to the function.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NeD9nNEkxF"}],"key":"x2WDG08ZYm"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Please read the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NNKkGwdjgj"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Matching Tutorial","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"e7RUwTxpF3"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","key":"wPsaikamNc"},{"type":"text","value":" for a step-by-step guide through the process of obtaining spatially and temporally coincident radar samples.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"duwfID6up3"}],"key":"HvP94QU0ev"}],"key":"nACBAWTLHI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s start the tutorial by importing the required packages:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DlPtZ326q7"}],"key":"rRdoppJI5j"}],"key":"MmDiOaY2yS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nfrom functools import reduce\n\nimport cartopy.crs as ccrs\nimport fsspec\nimport numpy as np\nimport xradar as xd\nimport xarray as xr\nfrom IPython.display import display\nfrom xarray.backends.api import open_datatree\nfrom gpm.gv import (\n    calibration_summary,\n    compare_maps,\n    reflectivity_scatterplots,\n    volume_matching,\n)\n\nnp.set_printoptions(suppress=True)","key":"YVBnvl3mB2"},{"type":"output","id":"wO-TgTR9Le1rK06BE71YV","data":[],"key":"Wzl63vBxqu"}],"key":"XKoqW4apVm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load SR and GR data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WT0pO3qpfx"}],"identifier":"load-sr-and-gr-data","label":"Load SR and GR data","html_id":"load-sr-and-gr-data","implicit":true,"key":"u1xMUqcPHg"}],"key":"bxGg8NoKsb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s open the NEXRAD GR data and the GPM granule with the coincident overpass.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q5i5qAjsz6"}],"key":"U5FKaQp2GG"}],"key":"UV2Sjv0Vl2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open fsspec connection to the bucket\nbucket_url = \"https://js2.jetstream-cloud.org:8001\"\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=bucket_url))","key":"uCKcZbjOjP"},{"type":"output","id":"hUCVt8adRGWdeTSLrrWBB","data":[],"key":"Tkvo72zYIv"}],"key":"R9yJarccXa"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the GR datatree\nfile = fs.get_mapper(f\"pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr\")\ndt_gr = open_datatree(file, engine=\"zarr\", consolidated=True, chunks={})\ndisplay(dt_gr)","key":"GMEZN78PLq"},{"type":"output","id":"uVeTEtHi4eY_iGMvRO6lG","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"bf885f3d2282e403e1a938f0dafd4efd","path":"/ams2025/_preview/3/build/bf885f3d2282e403e1a938f0dafd4efd.html"},"text/plain":{"content_type":"text/plain","hash":"a4ed0eb4ad3ad105da250c49d6296045","path":"/ams2025/_preview/3/build/a4ed0eb4ad3ad105da250c49d6296045.txt"}}}],"key":"I0nISuD1Pr"}],"key":"cQYgTXWuNg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the SR dataset\nfile = fs.get_mapper(\n    f\"pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr\"\n)\nds_sr = xr.open_zarr(file, consolidated=True, chunks={})","key":"p4PVIeIga5"},{"type":"output","id":"3ba-U8dffP_1LpDjoiyfz","data":[],"key":"CciSV5mm8t"}],"key":"FNt5ei4aTs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let’s select a GR sweep to match with GPM DPR:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XBKnyVHN4n"}],"key":"r92bZ2M42G"}],"key":"aqJHfIK2To"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Available sweeps:\", list(dt_gr.groups))","key":"KIpoSZF472"},{"type":"output","id":"jWn9aw41hyx8MLKfG8sQb","data":[{"name":"stdout","output_type":"stream","text":"Available sweeps: ['/', '/sweep_0', '/sweep_1', '/sweep_10', '/sweep_11', '/sweep_12', '/sweep_13', '/sweep_14', '/sweep_15', '/sweep_16', '/sweep_17', '/sweep_18', '/sweep_19', '/sweep_2', '/sweep_3', '/sweep_4', '/sweep_5', '/sweep_6', '/sweep_7', '/sweep_8', '/sweep_9']\n"}],"key":"EoBuyUSbl7"}],"key":"CmA1JRj2TO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sweep_idx = 0\nsweep_group = f\"sweep_{sweep_idx}\"  # GR sweep (elevation to be used)\nds_gr = dt_gr[sweep_group].to_dataset().compute()","key":"PriiqXOvR5"},{"type":"output","id":"AyL3ChdJEpeUqC9u8wZei","data":[],"key":"f78vaWTDYY"}],"key":"CqsB82Vbxu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and display the horizontally and vertically polarized reflectivity fields:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RzETKoG81Z"}],"key":"l5JfIY8YA5"}],"key":"NQnqMasn1d"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_gr[\"DBZH\"].where(ds_gr[\"DBZH\"] > -10).xradar_dev.plot_map()\nds_gr[\"DBZV\"] = (ds_gr[\"DBZH\"].gpm.idecibel / ds_gr[\"ZDR\"].gpm.idecibel).gpm.decibel\nds_gr[\"DBZV\"].where(ds_gr[\"DBZV\"] > -10).xradar_dev.plot_map()\n# ds_gr[\"ZDR\"].xradar_dev.plot_map()","key":"cHY7Wf4V5q"},{"type":"output","id":"Kf66AQBoI0UjFBcBPSz0q","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"<cartopy.mpl.geocollection.GeoQuadMesh at 0x7f3cbc66c110>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a9a7db40d9f9e009017ed7455931b9d","path":"/ams2025/_preview/3/build/2a9a7db40d9f9e009017ed7455931b9d.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b03ba9ec0dccbe161d5e1adfcdf75167","path":"/ams2025/_preview/3/build/b03ba9ec0dccbe161d5e1adfcdf75167.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"d33Yj18gIw"}],"key":"i8ZXSaqi1f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run SR/GR volume matching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RAcosvhUXY"}],"identifier":"run-sr-gr-volume-matching","label":"Run SR/GR volume matching","html_id":"run-sr-gr-volume-matching","implicit":true,"key":"iCaAsruZau"}],"key":"OovfhVTzCk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we start defining the required settings for the SR/GR volume matching procedure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vP4mlSWYi1"}],"key":"O25gWD5oRb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The GR ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iMcdFfKQj1"},{"type":"inlineCode","value":"radar_band","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dt0z8nElsB"},{"type":"text","value":" controls to which frequency SR Ku-band reflectivities will be converted. Valid values are ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k673mwA59S"},{"type":"inlineCode","value":"X","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RZEfKvcKYW"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GCfGDr53hW"},{"type":"inlineCode","value":"C","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rj3PyWdODw"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZrwTc0sPtM"},{"type":"inlineCode","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lP6ni2MFZO"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eyl6Mdv8Jp"},{"type":"inlineCode","value":"Ku","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uX3TTDI5R1"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yBQR7ivtqy"}],"key":"dh8j4NZY75"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ypsfk8RhkJ"},{"type":"inlineCode","value":"beamwidth_gr","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TUSi0WMCCr"},{"type":"text","value":" refers to the angular beam width of the GR.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZBTKkxvEd4"}],"key":"YYHfRkLza4"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The minimum reflectivity thresholds ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hXKJvA0px3"},{"type":"inlineCode","value":"z_min_threshold_sr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LFLZFmUGAE"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m6XymxMYEl"},{"type":"inlineCode","value":"z_min_threshold_gr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mh6TUZAiAY"},{"type":"text","value":" are used to mask out SR and GR\ngates belows such thresholds.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ddmNAhtCma"}],"key":"dOH9wwEfmr"}],"key":"H3oBx1akPZ"}],"key":"SijB9CtQPl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"radar_band = \"S\"\nbeamwidth_gr = 1\nz_min_threshold_gr = 0\nz_min_threshold_sr = 10","key":"Eebhts61vj"},{"type":"output","id":"M39DGu_5h-coCUCiVsYJt","data":[],"key":"qEY0ePFCzY"}],"key":"DF4zKw6Gjy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The SR/GR volume matching routine typically takes around 40-50 seconds to complete. It returns a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z31HmWujSL"},{"type":"inlineCode","value":"geopandas.DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rsAwoS6x7R"},{"type":"text","value":" with the matched aggregated reflectivities and the associated statistics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbjRHcGOOz"}],"key":"HpyMuXWlSl"}],"key":"kXie5vs5tD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match = volume_matching(\n    ds_gr=ds_gr,\n    ds_sr=ds_sr,\n    z_variable_gr=\"DBZH\",\n    radar_band=radar_band,\n    beamwidth_gr=beamwidth_gr,\n    z_min_threshold_gr=z_min_threshold_gr,\n    z_min_threshold_sr=z_min_threshold_sr,\n    min_gr_range=0,\n    max_gr_range=150_000,\n    # gr_sensitivity_thresholds=None,\n    # sr_sensitivity_thresholds=None,\n    download_sr=False,  # require internet connection !\n    display_quicklook=True,\n)\n# Note: The circle radius in the quicklook represents the min_gr_range, max_gr_range and 250_000 m range distances.","key":"s70iUQ7tLT"},{"type":"output","id":"ym56vh52P5XX0PSMinOc6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cd9c2dce763339e22f7d7d7605ea09b8","path":"/ams2025/_preview/3/build/cd9c2dce763339e22f7d7d7605ea09b8.png"},"text/plain":{"content":"<Figure size 960x480 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"SR/GR Matching Elapsed time: 0:00:40.298645 .\n"}],"key":"DSYSbcvuC4"}],"key":"NVKEkQTvx6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"display(gdf_match)","key":"OX1TE64IAQ"},{"type":"output","id":"JpDkAH5hTVIsBmscZ89c9","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>GR_Z_mean</th>\n      <th>GR_Z_std</th>\n      <th>GR_Z_max</th>\n      <th>GR_Z_min</th>\n      <th>GR_Z_range</th>\n      <th>GR_Z_cov</th>\n      <th>GR_time</th>\n      <th>GR_gate_volume_sum</th>\n      <th>GR_fraction_covered_area</th>\n      <th>GR_counts</th>\n      <th>...</th>\n      <th>sweep_number</th>\n      <th>along_track</th>\n      <th>cross_track</th>\n      <th>VolumeRatio</th>\n      <th>VolumeDiff</th>\n      <th>time_difference</th>\n      <th>GR_z_lower_bound</th>\n      <th>GR_z_upper_bound</th>\n      <th>SR_z_lower_bound</th>\n      <th>SR_z_upper_bound</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>15.221830</td>\n      <td>12.594024</td>\n      <td>19.5</td>\n      <td>10.5</td>\n      <td>9.0</td>\n      <td>0.827366</td>\n      <td>2023-08-20 22:13:43.619000064</td>\n      <td>1.325220e+09</td>\n      <td>0.523921</td>\n      <td>50.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>42</td>\n      <td>44.668064</td>\n      <td>5.786978e+10</td>\n      <td>97</td>\n      <td>1535.796701</td>\n      <td>4204.951593</td>\n      <td>1654.094116</td>\n      <td>4209.583984</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>13.581805</td>\n      <td>10.557827</td>\n      <td>18.5</td>\n      <td>10.0</td>\n      <td>8.5</td>\n      <td>0.777351</td>\n      <td>2023-08-20 22:13:43.513999872</td>\n      <td>1.316104e+09</td>\n      <td>0.792108</td>\n      <td>73.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>43</td>\n      <td>47.688195</td>\n      <td>6.144654e+10</td>\n      <td>97</td>\n      <td>1514.601481</td>\n      <td>4200.459785</td>\n      <td>1558.925415</td>\n      <td>4227.430664</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>16.550807</td>\n      <td>15.714381</td>\n      <td>23.0</td>\n      <td>10.0</td>\n      <td>13.0</td>\n      <td>0.949463</td>\n      <td>2023-08-20 22:13:43.414000128</td>\n      <td>1.304555e+09</td>\n      <td>0.966467</td>\n      <td>92.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>44</td>\n      <td>46.511517</td>\n      <td>5.937226e+10</td>\n      <td>97</td>\n      <td>1494.739411</td>\n      <td>4194.752350</td>\n      <td>1605.041138</td>\n      <td>4143.421875</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>19.808129</td>\n      <td>18.675347</td>\n      <td>26.0</td>\n      <td>11.0</td>\n      <td>15.0</td>\n      <td>0.942812</td>\n      <td>2023-08-20 22:13:43.315000064</td>\n      <td>1.292233e+09</td>\n      <td>1.000000</td>\n      <td>98.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>45</td>\n      <td>47.599161</td>\n      <td>6.021699e+10</td>\n      <td>97</td>\n      <td>1475.392380</td>\n      <td>4182.133888</td>\n      <td>1527.083740</td>\n      <td>4056.250488</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>18.983302</td>\n      <td>18.326115</td>\n      <td>24.5</td>\n      <td>10.0</td>\n      <td>14.5</td>\n      <td>0.965381</td>\n      <td>2023-08-20 22:13:43.212000000</td>\n      <td>1.280453e+09</td>\n      <td>1.000000</td>\n      <td>98.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>98</td>\n      <td>46</td>\n      <td>48.697237</td>\n      <td>6.107406e+10</td>\n      <td>97</td>\n      <td>1468.574285</td>\n      <td>4156.773245</td>\n      <td>1571.319336</td>\n      <td>4090.862549</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1300</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.476000000</td>\n      <td>NaN</td>\n      <td>0.994502</td>\n      <td>96.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>45</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1537.145386</td>\n      <td>4186.728516</td>\n    </tr>\n    <tr>\n      <th>1301</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.652999936</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>99.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>46</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1580.786865</td>\n      <td>4100.309082</td>\n    </tr>\n    <tr>\n      <th>1302</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.756000000</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>99.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>47</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1527.273315</td>\n      <td>4036.591797</td>\n    </tr>\n    <tr>\n      <th>1303</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.886000128</td>\n      <td>NaN</td>\n      <td>1.000000</td>\n      <td>104.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>157</td>\n      <td>48</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>64</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1469.200317</td>\n      <td>4086.919434</td>\n    </tr>\n    <tr>\n      <th>1304</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2023-08-20 22:13:51.857999872</td>\n      <td>NaN</td>\n      <td>0.606705</td>\n      <td>59.0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>158</td>\n      <td>48</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>63</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1598.747192</td>\n      <td>4216.467285</td>\n    </tr>\n  </tbody>\n</table>\n<p>1305 rows × 229 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"      GR_Z_mean   GR_Z_std  GR_Z_max  GR_Z_min  GR_Z_range  GR_Z_cov  \\\n0     15.221830  12.594024      19.5      10.5         9.0  0.827366   \n1     13.581805  10.557827      18.5      10.0         8.5  0.777351   \n2     16.550807  15.714381      23.0      10.0        13.0  0.949463   \n3     19.808129  18.675347      26.0      11.0        15.0  0.942812   \n4     18.983302  18.326115      24.5      10.0        14.5  0.965381   \n...         ...        ...       ...       ...         ...       ...   \n1300        NaN        NaN       NaN       NaN         NaN       NaN   \n1301        NaN        NaN       NaN       NaN         NaN       NaN   \n1302        NaN        NaN       NaN       NaN         NaN       NaN   \n1303        NaN        NaN       NaN       NaN         NaN       NaN   \n1304        NaN        NaN       NaN       NaN         NaN       NaN   \n\n                           GR_time  GR_gate_volume_sum  \\\n0    2023-08-20 22:13:43.619000064        1.325220e+09   \n1    2023-08-20 22:13:43.513999872        1.316104e+09   \n2    2023-08-20 22:13:43.414000128        1.304555e+09   \n3    2023-08-20 22:13:43.315000064        1.292233e+09   \n4    2023-08-20 22:13:43.212000000        1.280453e+09   \n...                            ...                 ...   \n1300 2023-08-20 22:13:51.476000000                 NaN   \n1301 2023-08-20 22:13:51.652999936                 NaN   \n1302 2023-08-20 22:13:51.756000000                 NaN   \n1303 2023-08-20 22:13:51.886000128                 NaN   \n1304 2023-08-20 22:13:51.857999872                 NaN   \n\n      GR_fraction_covered_area  GR_counts  ...  sweep_number along_track  \\\n0                     0.523921       50.0  ...             0          98   \n1                     0.792108       73.0  ...             0          98   \n2                     0.966467       92.0  ...             0          98   \n3                     1.000000       98.0  ...             0          98   \n4                     1.000000       98.0  ...             0          98   \n...                        ...        ...  ...           ...         ...   \n1300                  0.994502       96.0  ...             0         157   \n1301                  1.000000       99.0  ...             0         157   \n1302                  1.000000       99.0  ...             0         157   \n1303                  1.000000      104.0  ...             0         157   \n1304                  0.606705       59.0  ...             0         158   \n\n      cross_track  VolumeRatio    VolumeDiff  time_difference  \\\n0              42    44.668064  5.786978e+10               97   \n1              43    47.688195  6.144654e+10               97   \n2              44    46.511517  5.937226e+10               97   \n3              45    47.599161  6.021699e+10               97   \n4              46    48.697237  6.107406e+10               97   \n...           ...          ...           ...              ...   \n1300           45          NaN           NaN               64   \n1301           46          NaN           NaN               64   \n1302           47          NaN           NaN               64   \n1303           48          NaN           NaN               64   \n1304           48          NaN           NaN               63   \n\n      GR_z_lower_bound  GR_z_upper_bound  SR_z_lower_bound  SR_z_upper_bound  \n0          1535.796701       4204.951593       1654.094116       4209.583984  \n1          1514.601481       4200.459785       1558.925415       4227.430664  \n2          1494.739411       4194.752350       1605.041138       4143.421875  \n3          1475.392380       4182.133888       1527.083740       4056.250488  \n4          1468.574285       4156.773245       1571.319336       4090.862549  \n...                ...               ...               ...               ...  \n1300               NaN               NaN       1537.145386       4186.728516  \n1301               NaN               NaN       1580.786865       4100.309082  \n1302               NaN               NaN       1527.273315       4036.591797  \n1303               NaN               NaN       1469.200317       4086.919434  \n1304               NaN               NaN       1598.747192       4216.467285  \n\n[1305 rows x 229 columns]","content_type":"text/plain"}}}],"key":"HuCmocmzdV"}],"key":"LOulyHZsJc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyse SR/GR database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CYcbCd5z5l"}],"identifier":"analyse-sr-gr-database","label":"Analyse SR/GR database","html_id":"analyse-sr-gr-database","implicit":true,"key":"CPKeLch7LT"}],"key":"FURrPkPWwK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s first define the variables names of the SR and GR reflectivities:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TpEshWr35e"}],"key":"PfJuif4L6Q"}],"key":"IiF2GNd7Rr"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sr_z_column = f\"SR_zFactorFinal_{radar_band}_mean\"\ngr_z_column = \"GR_Z_mean\"","key":"ze4EZbXzGP"},{"type":"output","id":"S2mKUwq7AtsWIl51URXkg","data":[],"key":"PKOCZLZ8VO"}],"key":"UMU1bp8mu4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare spatial reflectivity fields","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LV5XDucN8n"}],"identifier":"compare-spatial-reflectivity-fields","label":"Compare spatial reflectivity fields","html_id":"compare-spatial-reflectivity-fields","implicit":true,"key":"gJGybjQQ3e"}],"key":"HE2SUOXtBU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we start comparing the spatial reflectivity fields without applying restrictive filtering criteria:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wYVHlvgbIq"}],"key":"tFpp7rO8Ya"}],"key":"k4XCHSZWQG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = compare_maps(\n    gdf_match,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"EOcRISLyNQ"},{"type":"output","id":"l2nDe_Pn07X87AfiENxEp","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f69a8e015263e8e349e1fd90ebbec133","path":"/ams2025/_preview/3/build/f69a8e015263e8e349e1fd90ebbec133.png"},"text/plain":{"content":"<Figure size 1400x700 with 4 Axes>","content_type":"text/plain"}}}],"key":"uswGRbZzrl"}],"key":"mnCmPhuoEf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you wish to create a cartopy map, specify the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f3ZLJKJsns"},{"type":"inlineCode","value":"'projection'","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uhMwEXJ5fc"},{"type":"text","value":" in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AkAiNdaLnj"},{"type":"inlineCode","value":"subplot_kwargs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GGkVcYWbOT"},{"type":"text","value":" argument:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zIMStEnMKz"}],"key":"TjSU16YKFF"}],"key":"aGIxzSK71Y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ccrs_gr_aeqd = ccrs.AzimuthalEquidistant(\n    central_longitude=ds_gr[\"longitude\"].item(),\n    central_latitude=ds_gr[\"latitude\"].item(),\n)\nsubplot_kwargs = {}\nsubplot_kwargs[\"projection\"] = ccrs_gr_aeqd\nfig = compare_maps(\n    gdf_match,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n    subplot_kwargs=subplot_kwargs,\n)\nfig.tight_layout()","key":"XLCgTRVrD5"},{"type":"output","id":"4zXpD_jvVdV5ptIesAa9g","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6418f7a4fade1337b1a1877fa193c546","path":"/ams2025/_preview/3/build/6418f7a4fade1337b1a1877fa193c546.png"},"text/plain":{"content":"<Figure size 1400x700 with 4 Axes>","content_type":"text/plain"}}}],"key":"U1TtQTlnjB"}],"key":"wiZuPuuvlm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we show how to explore interactively the reflectivity fields using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UsceqyZe3h"},{"type":"link","url":"https://python-visualization.github.io/folium/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Folium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"biGONTHzSz"}],"urlSource":"https://python-visualization.github.io/folium/latest/","key":"oWDE0dAr0w"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rfCH8df1zV"}],"key":"CaSSzNljpQ"}],"key":"lh2KgfKLWv"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match.explore(column=\"GR_Z_mean\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)","key":"xRXOOhcURN"},{"type":"output","id":"DdgliYL-9DPDGTHaU2rXo","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c42434202a01295fe64f9ba3c89f8a64","path":"/ams2025/_preview/3/build/c42434202a01295fe64f9ba3c89f8a64.html"},"text/plain":{"content":"<folium.folium.Map at 0x7f3cac9b0e50>","content_type":"text/plain"}}}],"key":"boDAn0gSba"}],"key":"zL5hLoOP49"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate calibration summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hfSPvEgDkV"}],"identifier":"generate-calibration-summary","label":"Generate calibration summary","html_id":"generate-calibration-summary","implicit":true,"key":"DMkY3cqlOq"}],"key":"C8n7v0lygl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now create a figure comparing SR/GR aggregated reflectivities volume-by-volume and displaying the overall distributions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XqJu5iFf3o"}],"key":"lz4fdc1r9l"}],"key":"AD9FbJRkGD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gr_z_column = \"GR_Z_mean\"\nsr_z_column = f\"SR_zFactorFinal_{radar_band}_mean\"\n\nfig = calibration_summary(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    hue_column=\"SR_fraction_clutter\",\n    # gr_range=[15, 50]\n    # sr_range=[15, 50]\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"QpzysW3Oz7"},{"type":"output","id":"4Yq7pujrjPIXMm6l06o2m","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c0526864872bc0723ed6409477f9cd1","path":"/ams2025/_preview/3/build/4c0526864872bc0723ed6409477f9cd1.png"},"text/plain":{"content":"<Figure size 1200x500 with 3 Axes>","content_type":"text/plain"}}}],"key":"WuQqc33LQa"}],"key":"APgthwWA3N"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Investigate filtering criteria","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PsbGMI83pJ"}],"identifier":"investigate-filtering-criteria","label":"Investigate filtering criteria","html_id":"investigate-filtering-criteria","implicit":true,"key":"OTfMDNECaM"}],"key":"zipHurpm1a"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When comparing SR and GR data or trying to determine an accurate GR calibration bias, it’s necessary to define a set of filtering criteria. In the figures below, we perform exploratory data analysis to investigate the relationships between the SR/GR reflectivity deviations and sets of variables characterizing radar measurements and SR/GR volume properties. The patterns and deviations observed in the scatterplots will be used to define a set of filtering critera in the next section of the tutorial.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"loWOS2OJny"}],"key":"SD1T4HMu5u"}],"key":"kpnfhseVqj"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Matching characteristics\nhue_columns = [\n    \"VolumeRatio\",\n    \"VolumeDiff\",\n    \"GR_vres_max\",\n    \"GR_range_max\",\n    \"GR_gate_volume_sum\",\n    \"SR_gate_volume_sum\",\n    \"SR_vres_sum\",\n    \"GR_fraction_covered_area\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"JkIB4uSLa6"},{"type":"output","id":"GvRprG4MC53dUrQ4aewYx","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d095fe2b910df0a0c298576956066ce8","path":"/ams2025/_preview/3/build/d095fe2b910df0a0c298576956066ce8.png"},"text/plain":{"content":"<Figure size 1200x2000 with 16 Axes>","content_type":"text/plain"}}}],"key":"EtNBZ0J3HR"}],"key":"X9PCYdtSSL"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Value validity & sensitivity\nhue_columns = [\n    \"GR_counts\",\n    \"GR_counts_valid\",\n    \"SR_counts\",\n    \"SR_counts_valid\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()\n\nhue_columns = [\n    \"SR_zFactorFinal_Ku_fraction_above_12dBZ\",\n    \"SR_zFactorFinal_Ku_fraction_above_14dBZ\",\n    \"GR_Z_fraction_above_10dBZ\",\n    \"GR_Z_fraction_above_12dBZ\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"wRJ8rv02qf"},{"type":"output","id":"wVSWw1lUkQZCe7HjEJ5Y7","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2fc3944cfbdd0ecd481521bf664e7c98","path":"/ams2025/_preview/3/build/2fc3944cfbdd0ecd481521bf664e7c98.png"},"text/plain":{"content":"<Figure size 1200x1000 with 8 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02c5e9c12c745d5c7acb234c43c5e81d","path":"/ams2025/_preview/3/build/02c5e9c12c745d5c7acb234c43c5e81d.png"},"text/plain":{"content":"<Figure size 1200x1000 with 8 Axes>","content_type":"text/plain"}}}],"key":"O9lcDNM9k6"}],"key":"DtYpb5oo61"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# NUBF & Variability\nhue_columns = [\n    \"SR_zFactorFinal_Ku_range\",\n    \"GR_Z_range\",\n    \"SR_zFactorFinal_Ku_std\",\n    \"GR_Z_std\",\n    \"SR_zFactorFinal_Ku_cov\",\n    \"GR_Z_cov\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"AzqAfBdxpH"},{"type":"output","id":"8Bw_0jVJkMECdmkmXgbhe","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"47bd777f02d9d2c93bb6a7898a853d03","path":"/ams2025/_preview/3/build/47bd777f02d9d2c93bb6a7898a853d03.png"},"text/plain":{"content":"<Figure size 1200x1500 with 12 Axes>","content_type":"text/plain"}}}],"key":"CYhBHIg6Hw"}],"key":"LY2PRgAGjd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Attenuation\nhue_columns = [\n    \"SR_pathAtten\",\n    \"SR_piaFinal\",\n    \"SR_zFactorCorrection_Ku_max\",\n    \"SR_zFactorCorrection_Ku_mean\",\n    \"SR_reliabFlag\",\n    \"GR_Z_cumsum_max\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"LppWZ4fR35"},{"type":"output","id":"sG93z3MMdwMzdf0N6Xwb3","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"459864f65e24acc6a2b61c360ef644f7","path":"/ams2025/_preview/3/build/459864f65e24acc6a2b61c360ef644f7.png"},"text/plain":{"content":"<Figure size 1200x1500 with 12 Axes>","content_type":"text/plain"}}}],"key":"t3yXFJQHYu"}],"key":"PADzvRwvnq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Hydrometeors\nhue_columns = [\n    \"SR_fraction_no_precip\",\n    \"SR_fraction_clutter\",\n    \"SR_fraction_rain\",\n    \"SR_fraction_snow\",\n    \"SR_fraction_hail\",\n    \"SR_fraction_below_isotherm\",\n    \"SR_fraction_above_isotherm\",\n    \"SR_fraction_melting_layer\",\n    # 'SR_airTemperature_min',\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"id2f4kqT5v"},{"type":"output","id":"cUhsv3TasvOUIWQjwmzD5","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"db3b1b7eacf87723da986a163dc5ef33","path":"/ams2025/_preview/3/build/db3b1b7eacf87723da986a163dc5ef33.png"},"text/plain":{"content":"<Figure size 1200x2000 with 16 Axes>","content_type":"text/plain"}}}],"key":"FN7ti6kTLB"}],"key":"qRyoEZUdLd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# SR Quality Flags\nhue_columns = [\n    \"SR_flagPrecipitationType\",\n    \"SR_qualityTypePrecip\",\n    \"SR_qualityBB\",\n    \"SR_flagPrecip\",\n    \"SR_qualityFlag\",\n    \"SR_dataQuality\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"vDRjVpMZHz"},{"type":"output","id":"GnZyA6Kjcy00ywzvJN-uP","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67ee650489e0041d42424b77394a1392","path":"/ams2025/_preview/3/build/67ee650489e0041d42424b77394a1392.png"},"text/plain":{"content":"<Figure size 1200x1500 with 12 Axes>","content_type":"text/plain"}}}],"key":"h9G4gbCpDJ"}],"key":"prFxJ7hIt2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define SR/GR filtering criteria","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QhDxXrTIoo"}],"identifier":"define-sr-gr-filtering-criteria","label":"Define SR/GR filtering criteria","html_id":"define-sr-gr-filtering-criteria","implicit":true,"key":"ADFOi1Own5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When calibrating or comparing SR and GR data, there is a necessary tradeoff between the strictness of filtering criteria filtering and the number of available samples. Here below we provide some general recommendations for effective filtering:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KUYRNicOK0"}],"key":"KlN2SIYJNw"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sensitivity Thresholds","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zQ0NuWP6qd"}],"key":"StCxtTEcNQ"},{"type":"text","value":": Retain only those radar beams where the aggregated gate reflectivities exceed the instrument sensitivities.\nThe ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EPFiGp0Py4"},{"type":"inlineCode","value":"GR_Z_fraction_above_<thr>dBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QmTTQrRFta"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B965d9P7Yu"},{"type":"inlineCode","value":"SR_zFactorFinal_Ku_fraction_above_<thr>dBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"X4eBoiEFAg"},{"type":"text","value":" variables can be used filter the samples.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eisXBt008q"}],"key":"Z1g6aEMVYZ"}],"key":"YjqeUsiMGg"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Stratiform Precipitation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nx3i8qsBay"}],"key":"GgV661fS4r"},{"type":"text","value":":  If the purpose of your analysis is to assess the calibration bias of GR data, it is suggested to focus on stratiform precipitation that ocurrs outside the melting layer (i.e. avoiding the bright band). Only stratiform samples above the melting layer are used in ground validation of the GPM DPR (W. Petersen 2017, personal communication).\nConvective SR footprints are typically excluded to avoid dealing with:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"usfOBZdFR3"}],"key":"zdPhYx5QXd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"the high spatial variability in the precipitation field and issues with non-uniform beam filling (NUBF),","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"W73IcfqIGo"}],"key":"QUX1zLVw3u"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"the potential biases introduced by the SR attenuation correction,","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uqtXS1zIBt"}],"key":"KHa5ofy8Ps"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"the potential biases in GR reflectivities, especially at C and X band, due to beam attenuation,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"U7gwXweLHJ"}],"key":"Tonr5riGhE"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"the multiple scattering signature caused by hail particles.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"q9pkbJBfP7"}],"key":"OMTl51ojAe"}],"key":"vAUn6NlKv1"}],"key":"oa6hyV3O1G"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Reflectivity Range","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"YfYqkIaC01"}],"key":"HasA8Yp8Le"},{"type":"text","value":": According to Warren et al. (2018), volume-averaged SR and GR reflectivity values should be selected within the range of 24 to 36 dBZ. This range minimizes the impact of low SR sensitivity,  SR beam attenuation and non-rayleigh scattering effects.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DPLofxjrrm"}],"key":"XthM6uDeFO"}],"key":"F7RqIqCiOS"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Clutter Removal","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XLVD3jvgxQ"}],"key":"ZAJkGjYpOn"},{"type":"text","value":": Exclude SR/GR samples that are contaminated by ground clutter, anomalous propagation, or beam blockage.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yt4d4FYc2A"}],"key":"Br1bcy7Rhb"}],"key":"cEzwcfKTky"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Volume matching","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"fik3w1JJcA"}],"key":"qvQex6wRqI"},{"type":"text","value":": Exclude SR/GR samples where there are excessive differences in the total gate volume.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"UhT2RbNOXm"}],"key":"A1LgloOUdN"}],"key":"n3B8etLZUP"}],"key":"L7bxXCW3jt"}],"key":"YBBvu9uWW0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define masks\nmasks = [\n    # Select SR scan with \"normal\" dataQuality (for entire cross-track scan)\n    gdf_match[\"SR_dataQuality\"] == 0,\n    # Select SR beams with detected precipitation\n    gdf_match[\"SR_flagPrecip\"] > 0,\n    # Select only 'high quality' SR data\n    # - qualityFlag == 1 indicates low quality retrievals\n    # - qualityFlag == 2 indicates bad/missing retrievals\n    gdf_match[\"SR_qualityFlag\"] == 0,\n    # Select SR beams with SR above minimum reflectivity\n    gdf_match[\"SR_zFactorFinal_Ku_fraction_above_12dBZ\"] > 0.95,\n    # Select SR beams with GR above minimum reflectivity\n    gdf_match[\"GR_Z_fraction_above_10dBZ\"] > 0.95,\n    # Select only SR beams with detected bright band\n    gdf_match[\"SR_qualityBB\"] == 1,\n    # Select only beams with confident precipitation type\n    gdf_match[\"SR_qualityTypePrecip\"] == 1,\n    # Select only stratiform precipitation\n    # - SR_flagPrecipitationType == 2 indicates convective\n    gdf_match[\"SR_flagPrecipitationType\"] == 1,\n    # Select only SR beams with reliable attenuation correction\n    gdf_match[\"SR_reliabFlag\"].isin((1, 2)),  # or == 1\n    # Select only beams with reduced path attenuation\n    # gdf_match[\"SR_zFactorCorrection_Ku_max\"]\n    # gdf_match[\"SR_piaFinal\"]\n    # gdf_match[\"SR_pathAtten\"]\n    # Select only SR beams with matching SR gates with no clutter\n    gdf_match[\"SR_fraction_clutter\"] == 0,\n    # Select only SR beams with matching SR gates not in the melting layer\n    gdf_match[\"SR_fraction_melting_layer\"] == 0,\n    # Select only SR beams with matching SR gates with precipitation\n    gdf_match[\"SR_fraction_no_precip\"] == 0,\n    # Select only SR beams with matching SR gates with no hail\n    gdf_match[\"SR_fraction_hail\"] == 0,\n    # Select only SR beams with matching SR gates with rain\n    # gdf_match[\"SR_fraction_rain\"] == 1,\n    # Select only SR beams with matching SR gates with snow\n    # gdf_match[\"SR_fraction_snow\"] == 1,\n    # Discard SR beams with high NUBF\n    # gdf_match[\"SR_zFactorFinal_Ku_range\"] > 5,\n    # gdf_match[\"SR_zFactorFinal_Ku_cov\"] < 0.5,\n    # gdf_match[\"GR_Z_cov\"] < 0.5,\n    gdf_match[\"GR_Z_range\"] < 15,\n    # Select only interval of reflectivities\n    # - Warren et al., 2018:  between 24 and 36 dBZ\n    # (gdf_match[\"SR_zFactorFinal_Ku_mean\"] > 24) & (gdf_match[\"SR_zFactorFinal_Ku_mean\"] < 36),\n    # (gdf_match[\"GR_Z_mean\"] > 24) & (gdf_match[\"GR_Z_mean\"] < 36),\n    # Select SR beams only within given GR radius interval\n    # (gdf_match[\"GR_range_min\"] > min_gr_range) & (gdf_match[\"GR_range_max\"] < max_gr_range),\n    # Discard SR beams where scanning time difference > 5 minutes\n    # - time_difference is in seconds !\n    gdf_match[\"time_difference\"] < 60 * 5,\n    # Discard SR beams where GR gates does not cover 80% of the horizontal area\n    gdf_match[\"GR_fraction_covered_area\"] > 0.8,\n    # # Filter footprints where volume ratio exceeds 60\n    # gdf_match[\"VolumeRatio\"] > 60,\n    # Filter footprints where GR affected by beam blockage\n    # TODO: Filtering by beam blockage\n]","key":"saTHzZpoQp"},{"type":"output","id":"J3qV2LbB09xEFn2k0sUlP","data":[],"key":"Th0mWyrpoR"}],"key":"sy7viuvy6M"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define final mask\nmask_final = reduce(np.logical_and, masks)","key":"qoRQA0bQAA"},{"type":"output","id":"ZukoQGr3XJUwovKZyCcBw","data":[],"key":"cFrjjmTx2E"}],"key":"QCpiU9ki7J"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Dsplay final filtering mask\ngdf_match[\"filtering_mask\"] = mask_final\nreflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=\"filtering_mask\",\n    marker=\"o\",\n    s=1,\n    cmap=\"viridis_r\",\n)","key":"E6BCfEH8ub"},{"type":"output","id":"w-JjTL3MRmR6dx3dCNZcz","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"34e391bfe4b88effc44426d540a2c632","path":"/ams2025/_preview/3/build/34e391bfe4b88effc44426d540a2c632.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"TUVIYwz5FE"}],"key":"w5F3TIbyCR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyze filtered SR/GR database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IdEu1QSaLk"}],"identifier":"analyze-filtered-sr-gr-database","label":"Analyze filtered SR/GR database","html_id":"analyze-filtered-sr-gr-database","implicit":true,"key":"gN0NgXLB85"}],"key":"Atz3xc5c2Y"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now filter the SR/GR Database, compare the reflectivity fields and display the new calibration summary:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hBbNOwqLq4"}],"key":"ucJuRGbief"}],"key":"RERred1Vxn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_final = gdf_match[mask_final]","key":"taEjfzSpDw"},{"type":"output","id":"CmnvuJ3chVW9yebr8xZmG","data":[],"key":"bRva2Fji1b"}],"key":"JKU7UtNiGz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = compare_maps(\n    gdf_final,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"v3HJcSo7Hr"},{"type":"output","id":"Bmd0x09b1m7tqxBu1Fw8c","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9b4586875887af4ac7f9910d9d432065","path":"/ams2025/_preview/3/build/9b4586875887af4ac7f9910d9d432065.png"},"text/plain":{"content":"<Figure size 1400x700 with 4 Axes>","content_type":"text/plain"}}}],"key":"KRRPp9DYyr"}],"key":"AjBdYvD2EF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = calibration_summary(\n    df=gdf_final,\n    sr_z_column=sr_z_column,\n    gr_z_column=gr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    # hue_column=\"GR_gate_volume_sum\",\n    hue_column=\"GR_range_mean\",\n    # gr_range=[15, 50]\n    # sr_range=[15, 50]\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"u3lK520fpn"},{"type":"output","id":"6WzEYghMbVvvNIDvhNYqS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"351d96bc0ba4ae87d57610020c20b769","path":"/ams2025/_preview/3/build/351d96bc0ba4ae87d57610020c20b769.png"},"text/plain":{"content":"<Figure size 1200x500 with 3 Axes>","content_type":"text/plain"}}}],"key":"uRRoFSD2g6"}],"key":"oQEZNSYgdj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exploratory data analysis can again be performed to check if the filtering criteria were effective to discard the undesired SR/GR matched volumes and if the filtering criteria should be further expanded.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zcoaEOMpR7"}],"key":"rish9hQ67f"}],"key":"xGrK0H3OCp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Attenuation\nhue_columns = [\n    \"SR_pathAtten\",\n    \"SR_piaFinal\",\n    \"SR_reliabFlag\",\n    \"SR_zFactorCorrection_Ku_max\",\n    \"SR_zFactorCorrection_Ku_mean\",\n    \"GR_Z_cumsum_max\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_final,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"Cp3OUkw3J3"},{"type":"output","id":"T3lf-INfOPnE2ZHd8Z3Tw","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f27ea0fbfb2d756e98535a53eccd7133","path":"/ams2025/_preview/3/build/f27ea0fbfb2d756e98535a53eccd7133.png"},"text/plain":{"content":"<Figure size 1200x1500 with 12 Axes>","content_type":"text/plain"}}}],"key":"Hlhqjkb4J6"}],"key":"VtdRKx9kzH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine GR calibration bias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VDGysbp3Ov"}],"identifier":"determine-gr-calibration-bias","label":"Determine GR calibration bias","html_id":"determine-gr-calibration-bias","implicit":true,"key":"i794NjUG7b"}],"key":"AcDekIIwdu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The GR calibration bias can be obtained by averaging the difference between the matched SR/GR reflectivity measurements:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYG6GQv9OJ"}],"key":"dREMv9hWiY"}],"key":"E2xp6D5g2P"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute average offset\nz_offset = np.nanmean(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)\nz_offset_robust = np.nanmedian(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)\n\nprint(f\"Th ZH Calibration offset is (mean): {z_offset} dBZ\")\nprint(f\"Th ZH Calibration offset is (median): {z_offset_robust} dBZ\")","key":"q4qYcRy09x"},{"type":"output","id":"AtWP8KLGlJp0n5okh76zs","data":[{"name":"stdout","output_type":"stream","text":"Th ZH Calibration offset is (mean): 3.94 dBZ\nTh ZH Calibration offset is (median): 3.78 dBZ\n"}],"key":"T5YkVNuGzW"}],"key":"WtQPuvuIsg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Volume matching with calibrated GR","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kzmpC4i8YO"}],"identifier":"volume-matching-with-calibrated-gr","label":"Volume matching with calibrated GR","html_id":"volume-matching-with-calibrated-gr","implicit":true,"key":"NWQZwZeyPf"}],"key":"vRpSoif65B"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we remove the estimated GR calibration bias, we rerun the SR/GR volume matching procedure, we compare the matched reflectivities and we assess if we have effectively removed the bias by generating the calibration summary. Please note that here below we don’t filter out  undesired SR/GR volumes, but this is operation is recommended once you defined appropriate robust filtering criteria !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g7idvNfN9z"}],"key":"rqc93wzH17"}],"key":"FRRqkLBYBM"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Apply offset\nds_gr[\"DBZH_c\"] = ds_gr[\"DBZH\"] + z_offset","key":"yakeGo68p0"},{"type":"output","id":"ZanAgRqhmJwY29LjaFuM2","data":[],"key":"yX1tMaihRX"}],"key":"OJYgZUSPcm"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Apply matching\ngdf_match_corrected = volume_matching(\n    ds_gr=ds_gr,\n    ds_sr=ds_sr,\n    z_variable_gr=\"DBZH_c\",\n    radar_band=radar_band,\n    beamwidth_gr=beamwidth_gr,\n    z_min_threshold_gr=z_min_threshold_gr,\n    z_min_threshold_sr=z_min_threshold_sr,\n    min_gr_range=0,\n    max_gr_range=150_000,\n    # gr_sensitivity_thresholds=None,\n    # sr_sensitivity_thresholds=None,\n    download_sr=False,  # require internet connection !\n)","key":"KfcTaw9d8k"},{"type":"output","id":"EpDnYbmm8F8nT5W64cVjV","data":[{"name":"stdout","output_type":"stream","text":"'scan_mode' has not been specified. Default to FS.\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2c731ecfa35ca9230bed9a70bce4c492","path":"/ams2025/_preview/3/build/2c731ecfa35ca9230bed9a70bce4c492.png"},"text/plain":{"content":"<Figure size 960x480 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"SR/GR Matching Elapsed time: 0:00:41.182549 .\n"}],"key":"iBeeXSg7rq"}],"key":"hSCnKQXSun"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compare reflectivities\nfig = compare_maps(\n    gdf_match_corrected,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"WV6ep4P68K"},{"type":"output","id":"PTTtMk_3hZVkS8G0P6aaR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6f63679018b7a0f687d443143c8009ef","path":"/ams2025/_preview/3/build/6f63679018b7a0f687d443143c8009ef.png"},"text/plain":{"content":"<Figure size 1400x700 with 4 Axes>","content_type":"text/plain"}}}],"key":"MmxujiEL3B"}],"key":"qTYs3tb66B"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display difference in reflectivity betweeen SR and GR\ngdf_match_corrected[\"z_offset\"] = gdf_match_corrected[sr_z_column] - gdf_match_corrected[gr_z_column]\ngdf_match_corrected.plot(column=\"z_offset\", legend=True, cmap=\"RdBu\", vmin=-1.5, vmax=1.5)","key":"eixe5qL6FD"},{"type":"output","id":"qW3NBCp1wBqghXtCKuv7c","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"<Axes: >","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c87656dcf4c9f891a23eca853a701ac4","path":"/ams2025/_preview/3/build/c87656dcf4c9f891a23eca853a701ac4.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"eQHdFy7wtj"}],"key":"FTp2jYr8U8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display calibration summary\nfig = calibration_summary(\n    df=gdf_match_corrected,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    hue_column=\"SR_fraction_clutter\",\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"LxHQNJ9rVG"},{"type":"output","id":"HU4iWFPtNcmJBiwj76Osv","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9fe9905ef3ee84262a16592059135c23","path":"/ams2025/_preview/3/build/9fe9905ef3ee84262a16592059135c23.png"},"text/plain":{"content":"<Figure size 1200x500 with 3 Axes>","content_type":"text/plain"}}}],"key":"ybc3GkWgIn"}],"key":"OE5f9vxlzV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BPhzS9SUSr"}],"identifier":"next-steps","label":"Next steps","html_id":"next-steps","implicit":true,"key":"K50K3wNbaL"}],"key":"pD7ryIYKOr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We encourage you to explore and adapt the code provided in this tutorial to infer calibration bias also\nfor the vertically polarized channel, iterate over GR sweeps, analyze multiple GPM overpasses, and assess the\nlong-term calibration bias of your GR network.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TiRYIhoPD9"}],"key":"spERwVXxK1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Please share any insights or suggestions for improving the matching procedure or filtering criteria with\nthe GPM-API community so we can collaboratively enhance the routines.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yjG31J2LsL"}],"key":"iBlkyuyl2O"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We hope you enjoyed the tutorial! 😊","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JkPAgJCZqm"}],"key":"oJiGCKnshF"}],"key":"WhH4t1s2ji"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOscBo54Tw"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"f4lR85WFhK"}],"key":"sxGcrTzeyH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cao, Q., Y. Hong, Y. Qi, Y. Wen, J. Zhang, J. J. Gourley, and L. Liao, 2013: Empirical conversion of the vertical profile of reflectivity from Ku-band to S-band frequency. J. Geophys. Res. Atmos., 118, 1814–1825, https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FbjAdXFaGn"}],"kind":"narrative","label":"Cao_2013","identifier":"https://doi.org/10.1002/jgrd.50138","enumerator":"1","key":"WWzIkRDF0D"}],"key":"mvGThpLuh9"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Schwaller, MR, and Morris, KR. 2011. A ground validation network for the Global Precipitation Measurement mission. J. Atmos. Oceanic Technol., 28, 301-319.28, https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OuKuY7PYsJ"}],"kind":"narrative","label":"Schwaller_2011","identifier":"https://doi.org/10.1175/2010JTECHA1403.1","enumerator":"2","key":"j5dMQCZwLu"}],"key":"ebOgMWRr77"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Warren, R.A., A. Protat, S.T. Siems, H.A. Ramsay, V. Louf, M.J. Manton, and T.A. Kane, 2018. Calibrating ground-based radars against TRMM and GPM. J. Atmos. Oceanic Technol., 35, 323–346, https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OPKw9u0tl4"}],"kind":"narrative","label":"Warren_2018","identifier":"https://doi.org/10.1175/JTECH-D-17-0128.1","enumerator":"3","key":"twlD8OeRs4"}],"key":"TeG2t9BTMb"}],"key":"JrqDMqN59n"}],"key":"oxtUI0Tavl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Citation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rlt9bNHoIk"}],"identifier":"citation","label":"Citation","html_id":"citation","implicit":true,"key":"g0CtCjY48m"}],"key":"RENc4XbxrL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook is part of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zwvCdx1AOf"},{"type":"link","url":"https://gpm-api.readthedocs.io/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API  documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mmjsrrZDB7"}],"urlSource":"https://gpm-api.readthedocs.io/","key":"dnmneyP3vx"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eYZj6rBPlM"}],"key":"XQ86hA3Q8F"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Large portions of this tutorials were adapted and derived from an old ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fIp6lnLS6W"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\\omega radlib</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ib</span></span></span></span>","key":"AzYSu73FNX"},{"type":"text","value":"  tutorial.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fEZPvzEdL9"}],"key":"PvwQxq0tVP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Copyright: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yrT6eBzCd3"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\\omega radlib</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ib</span></span></span></span>","key":"LjpoVULmcG"},{"type":"text","value":"  and GPM-API developers.\nDistributed under the MIT License. See ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NjjYYHpb9n"},{"type":"link","url":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"GPM-API license","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zsIjxTj9H2"}],"urlSource":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","data":{"kind":"file","org":"ghiggi","repo":"gpm_api","reference":"main","file":"LICENSE","raw":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/LICENSE"},"internal":false,"protocol":"github","key":"Xxl18wIsG4"},{"type":"text","value":" for more info.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PWJTluEaLr"}],"key":"aDkrqKpjbv"}],"key":"EGOTbykJFQ"}],"key":"NRLVQJ48od"},"references":{"cite":{"order":["Cao_2013","Schwaller_2011","Warren_2018"],"data":{"Cao_2013":{"label":"Cao_2013","enumerator":"1","doi":"10.1002/jgrd.50138","html":"Cao, Q., Hong, Y., Qi, Y., Wen, Y., Zhang, J., Gourley, J. J., & Liao, L. (2013). Empirical conversion of the vertical profile of reflectivity from Ku‐band to S‐band frequency. <i>Journal of Geophysical Research: Atmospheres</i>, <i>118</i>(4), 1814–1825. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1002/jgrd.50138\">10.1002/jgrd.50138</a>","url":"https://doi.org/10.1002/jgrd.50138"},"Schwaller_2011":{"label":"Schwaller_2011","enumerator":"2","doi":"10.1175/2010jtecha1403.1","html":"Schwaller, M. R., & Morris, K. R. (2011). A Ground Validation Network for the Global Precipitation Measurement Mission. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>28</i>(3), 301–319. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/2010jtecha1403.1\">10.1175/2010jtecha1403.1</a>","url":"https://doi.org/10.1175/2010jtecha1403.1"},"Warren_2018":{"label":"Warren_2018","enumerator":"3","doi":"10.1175/jtech-d-17-0128.1","html":"Warren, R. A., Protat, A., Siems, S. T., Ramsay, H. A., Louf, V., Manton, M. J., & Kane, T. A. (2018). Calibrating Ground-Based Radars against TRMM and GPM. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>35</i>(2), 323–346. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/jtech-d-17-0128.1\">10.1175/jtech-d-17-0128.1</a>","url":"https://doi.org/10.1175/jtech-d-17-0128.1"}}}},"footer":{"navigation":{"prev":{"title":"QPE & QVPs","url":"/qpe-qvps","group":"ARCO Radar Datasets"},"next":{"title":"Spaceborne-Ground Radar Matching (Methodology)","url":"/sr-gr-matching-procedure","group":"Spaceborne - Ground Radar Matching and Calibration"}}},"domain":"http://localhost:3000"}